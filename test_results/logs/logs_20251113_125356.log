2025-11-13 12:53:56,161 - INFO - Args: Namespace(num_seeds=4, seeds=[0, 1, 2, 3], sequence_length=5, num_sequences=1, student_dims=[10, 20, 50, 100, 150, 300], eps_train=1e-05, w_that_minimizes_loss=False, w2_that_minimizes_loss=False, w2_that_maximizes_loss=False, data_file=PosixPath('alpha_w_pairs.json'), gnc=True, gnc_num_samples=1000000000, gnc_batch_size=500000, gd=True, gd_lr=0.001, gd_epochs=100000, gd_init_scale=0.01, gd_optimizer='adam', gd_scheduler='adaptive', gd_scheduler_params='{"base_lr": 0.00001}', exp_gamma=None, step_size=None, step_gamma=None, cosine_eta_min=None, gd_init_type='regular', gd_base_lr=0.001, gd_beta=0.8, gd_soft_const=1e-06, config=None, results_dir=PosixPath('test_results/results'), figures_dir=PosixPath('test_results/figures'), checkpoint_dir=PosixPath('test_results/checkpoints'), checkpoint_interval=3600, resume_from_checkpoint=False, log_dir=PosixPath('test_results/logs'), max_gpus=8, log_file=PosixPath('test_results/logs/logs_20251113_125356.log'))
2025-11-13 12:53:56,162 - INFO - Using custom seeds: [0, 1, 2, 3]
2025-11-13 12:53:56,342 - INFO - Using GPUs: [0, 1, 2, 3, 4, 5, 6, 7]
2025-11-13 12:53:56,343 - INFO - Starting 8 processes on 8 GPUs
2025-11-13 12:53:59,996 - INFO - Process 0 started on GPU 0, processing seeds [0]
2025-11-13 12:54:00,277 - INFO - Process 2 started on GPU 2, processing seeds [2]
2025-11-13 12:54:00,346 - INFO - Process 1 started on GPU 1, processing seeds [1]
2025-11-13 12:54:00,460 - INFO - Process 3 started on GPU 3, processing seeds [3]
2025-11-13 12:54:00,476 - INFO - for seed 2, loaded alpha_teacher=tensor([0.5000], device='cuda:2'), loaded 1 sequences: [tensor([0., 0., 0., 1.], device='cuda:2')]
2025-11-13 12:54:00,477 - INFO - Process 2: Starting experiment - student_dim=10, seed=2
2025-11-13 12:54:00,480 - INFO - for seed 0, loaded alpha_teacher=tensor([0.5000], device='cuda:0'), loaded 1 sequences: [tensor([1., 0., 0., 0.], device='cuda:0')]
2025-11-13 12:54:00,480 - INFO - Process 0: Starting experiment - student_dim=10, seed=0
2025-11-13 12:54:00,559 - INFO - for seed 1, loaded alpha_teacher=tensor([0.5000], device='cuda:1'), loaded 1 sequences: [tensor([0.0100, 0.0100, 0.0100, 1.0000], device='cuda:1')]
2025-11-13 12:54:00,560 - INFO - Process 1: Starting experiment - student_dim=10, seed=1
2025-11-13 12:54:00,594 - ERROR - G&C failed for student_dim=10, seed=2: cannot access local variable 'gnc_loss_variance' where it is not associated with a value
2025-11-13 12:54:00,596 - ERROR - Traceback (most recent call last):
  File "/home/fodl/noacaspi/ssm_generalize/main.py", line 99, in process_worker
    mean_prior, gnc_gen_loss, variance_gnc = train_gnc(seed, student_dim, device, alpha_teacher, w_sequences,
                                             ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        args_dict['eps_train'], args_dict['gnc_num_samples'],
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        batch_size, False)
                                        ^^^^^^^^^^^^^^^^^^
  File "/home/fodl/noacaspi/ssm_generalize/training.py", line 259, in train_gnc
    gnc_loss_variance += torch.var(gen_loss[finite_mask])
    ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'gnc_loss_variance' where it is not associated with a value

2025-11-13 12:54:00,596 - INFO - Using adaptive scheduler with base_lr=None, beta=None, soft_const=None
2025-11-13 12:54:00,596 - INFO - Calling train_gd with scheduler_params: {'base_lr': None, 'beta': None, 'soft_const': None}
2025-11-13 12:54:00,597 - ERROR - G&C failed for student_dim=10, seed=0: cannot access local variable 'gnc_loss_variance' where it is not associated with a value
2025-11-13 12:54:00,599 - ERROR - Traceback (most recent call last):
  File "/home/fodl/noacaspi/ssm_generalize/main.py", line 99, in process_worker
    mean_prior, gnc_gen_loss, variance_gnc = train_gnc(seed, student_dim, device, alpha_teacher, w_sequences,
                                             ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        args_dict['eps_train'], args_dict['gnc_num_samples'],
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        batch_size, False)
                                        ^^^^^^^^^^^^^^^^^^
  File "/home/fodl/noacaspi/ssm_generalize/training.py", line 259, in train_gnc
    gnc_loss_variance += torch.var(gen_loss[finite_mask])
    ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'gnc_loss_variance' where it is not associated with a value

2025-11-13 12:54:00,599 - INFO - Using adaptive scheduler with base_lr=None, beta=None, soft_const=None
2025-11-13 12:54:00,599 - INFO - Calling train_gd with scheduler_params: {'base_lr': None, 'beta': None, 'soft_const': None}
2025-11-13 12:54:00,666 - INFO - for seed 3, loaded alpha_teacher=tensor([0.5000], device='cuda:3'), loaded 1 sequences: [tensor([1., 1., 1., 1.], device='cuda:3')]
2025-11-13 12:54:00,666 - INFO - Process 3: Starting experiment - student_dim=10, seed=3
2025-11-13 12:54:00,679 - ERROR - G&C failed for student_dim=10, seed=1: cannot access local variable 'gnc_loss_variance' where it is not associated with a value
2025-11-13 12:54:00,680 - ERROR - Traceback (most recent call last):
  File "/home/fodl/noacaspi/ssm_generalize/main.py", line 99, in process_worker
    mean_prior, gnc_gen_loss, variance_gnc = train_gnc(seed, student_dim, device, alpha_teacher, w_sequences,
                                             ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        args_dict['eps_train'], args_dict['gnc_num_samples'],
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        batch_size, False)
                                        ^^^^^^^^^^^^^^^^^^
  File "/home/fodl/noacaspi/ssm_generalize/training.py", line 259, in train_gnc
    gnc_loss_variance += torch.var(gen_loss[finite_mask])
    ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'gnc_loss_variance' where it is not associated with a value

2025-11-13 12:54:00,681 - INFO - Using adaptive scheduler with base_lr=None, beta=None, soft_const=None
2025-11-13 12:54:00,681 - INFO - Calling train_gd with scheduler_params: {'base_lr': None, 'beta': None, 'soft_const': None}
2025-11-13 12:54:00,791 - ERROR - G&C failed for student_dim=10, seed=3: cannot access local variable 'gnc_loss_variance' where it is not associated with a value
2025-11-13 12:54:00,792 - ERROR - Traceback (most recent call last):
  File "/home/fodl/noacaspi/ssm_generalize/main.py", line 99, in process_worker
    mean_prior, gnc_gen_loss, variance_gnc = train_gnc(seed, student_dim, device, alpha_teacher, w_sequences,
                                             ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        args_dict['eps_train'], args_dict['gnc_num_samples'],
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        batch_size, False)
                                        ^^^^^^^^^^^^^^^^^^
  File "/home/fodl/noacaspi/ssm_generalize/training.py", line 259, in train_gnc
    gnc_loss_variance += torch.var(gen_loss[finite_mask])
    ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'gnc_loss_variance' where it is not associated with a value

2025-11-13 12:54:00,793 - INFO - Using adaptive scheduler with base_lr=None, beta=None, soft_const=None
2025-11-13 12:54:00,793 - INFO - Calling train_gd with scheduler_params: {'base_lr': None, 'beta': None, 'soft_const': None}
2025-11-13 12:54:02,622 - INFO - initial model: max A_j index: 4
2025-11-13 12:54:02,664 - ERROR - GD failed for student_dim=10, seed=2: unsupported operand type(s) for /: 'NoneType' and 'float'
2025-11-13 12:54:02,668 - INFO - Process 2: Completed experiment - student_dim=10, seed=2
2025-11-13 12:54:02,680 - ERROR - G&C failed for student_dim=20, seed=2: cannot access local variable 'gnc_loss_variance' where it is not associated with a value
2025-11-13 12:54:02,683 - ERROR - Traceback (most recent call last):
  File "/home/fodl/noacaspi/ssm_generalize/main.py", line 99, in process_worker
    mean_prior, gnc_gen_loss, variance_gnc = train_gnc(seed, student_dim, device, alpha_teacher, w_sequences,
                                             ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        args_dict['eps_train'], args_dict['gnc_num_samples'],
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        batch_size, False)
                                        ^^^^^^^^^^^^^^^^^^
  File "/home/fodl/noacaspi/ssm_generalize/training.py", line 259, in train_gnc
    gnc_loss_variance += torch.var(gen_loss[finite_mask])
    ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'gnc_loss_variance' where it is not associated with a value

2025-11-13 12:54:02,683 - INFO - Using adaptive scheduler with base_lr=None, beta=None, soft_const=None
2025-11-13 12:54:02,684 - INFO - Calling train_gd with scheduler_params: {'base_lr': None, 'beta': None, 'soft_const': None}
2025-11-13 12:54:02,686 - INFO - initial model: max A_j index: 15
2025-11-13 12:54:02,690 - ERROR - GD failed for student_dim=20, seed=2: unsupported operand type(s) for /: 'NoneType' and 'float'
2025-11-13 12:54:02,694 - INFO - initial model: max A_j index: 0
2025-11-13 12:54:02,695 - INFO - Process 2: Completed experiment - student_dim=20, seed=2
2025-11-13 12:54:02,717 - ERROR - G&C failed for student_dim=50, seed=2: cannot access local variable 'gnc_loss_variance' where it is not associated with a value
2025-11-13 12:54:02,718 - ERROR - Traceback (most recent call last):
  File "/home/fodl/noacaspi/ssm_generalize/main.py", line 99, in process_worker
    mean_prior, gnc_gen_loss, variance_gnc = train_gnc(seed, student_dim, device, alpha_teacher, w_sequences,
                                             ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        args_dict['eps_train'], args_dict['gnc_num_samples'],
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        batch_size, False)
                                        ^^^^^^^^^^^^^^^^^^
  File "/home/fodl/noacaspi/ssm_generalize/training.py", line 259, in train_gnc
    gnc_loss_variance += torch.var(gen_loss[finite_mask])
    ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'gnc_loss_variance' where it is not associated with a value

2025-11-13 12:54:02,718 - INFO - Using adaptive scheduler with base_lr=None, beta=None, soft_const=None
2025-11-13 12:54:02,718 - INFO - Calling train_gd with scheduler_params: {'base_lr': None, 'beta': None, 'soft_const': None}
2025-11-13 12:54:02,719 - INFO - initial model: max A_j index: 27
2025-11-13 12:54:02,721 - ERROR - GD failed for student_dim=50, seed=2: unsupported operand type(s) for /: 'NoneType' and 'float'
2025-11-13 12:54:02,726 - INFO - Process 2: Completed experiment - student_dim=50, seed=2
2025-11-13 12:54:02,752 - ERROR - GD failed for student_dim=10, seed=0: unsupported operand type(s) for /: 'NoneType' and 'float'
2025-11-13 12:54:02,755 - INFO - Process 0: Completed experiment - student_dim=10, seed=0
2025-11-13 12:54:02,761 - ERROR - G&C failed for student_dim=100, seed=2: cannot access local variable 'gnc_loss_variance' where it is not associated with a value
2025-11-13 12:54:02,761 - ERROR - Traceback (most recent call last):
  File "/home/fodl/noacaspi/ssm_generalize/main.py", line 99, in process_worker
    mean_prior, gnc_gen_loss, variance_gnc = train_gnc(seed, student_dim, device, alpha_teacher, w_sequences,
                                             ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        args_dict['eps_train'], args_dict['gnc_num_samples'],
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        batch_size, False)
                                        ^^^^^^^^^^^^^^^^^^
  File "/home/fodl/noacaspi/ssm_generalize/training.py", line 259, in train_gnc
    gnc_loss_variance += torch.var(gen_loss[finite_mask])
    ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'gnc_loss_variance' where it is not associated with a value

2025-11-13 12:54:02,762 - INFO - Using adaptive scheduler with base_lr=None, beta=None, soft_const=None
2025-11-13 12:54:02,762 - INFO - Calling train_gd with scheduler_params: {'base_lr': None, 'beta': None, 'soft_const': None}
2025-11-13 12:54:02,763 - INFO - initial model: max A_j index: 27
2025-11-13 12:54:02,765 - ERROR - GD failed for student_dim=100, seed=2: unsupported operand type(s) for /: 'NoneType' and 'float'
2025-11-13 12:54:02,767 - ERROR - G&C failed for student_dim=20, seed=0: cannot access local variable 'gnc_loss_variance' where it is not associated with a value
2025-11-13 12:54:02,768 - ERROR - Traceback (most recent call last):
  File "/home/fodl/noacaspi/ssm_generalize/main.py", line 99, in process_worker
    mean_prior, gnc_gen_loss, variance_gnc = train_gnc(seed, student_dim, device, alpha_teacher, w_sequences,
                                             ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        args_dict['eps_train'], args_dict['gnc_num_samples'],
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        batch_size, False)
                                        ^^^^^^^^^^^^^^^^^^
  File "/home/fodl/noacaspi/ssm_generalize/training.py", line 259, in train_gnc
    gnc_loss_variance += torch.var(gen_loss[finite_mask])
    ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'gnc_loss_variance' where it is not associated with a value

2025-11-13 12:54:02,769 - INFO - Using adaptive scheduler with base_lr=None, beta=None, soft_const=None
2025-11-13 12:54:02,769 - INFO - Calling train_gd with scheduler_params: {'base_lr': None, 'beta': None, 'soft_const': None}
2025-11-13 12:54:02,770 - INFO - initial model: max A_j index: 18
2025-11-13 12:54:02,770 - INFO - Process 2: Completed experiment - student_dim=100, seed=2
2025-11-13 12:54:02,773 - ERROR - GD failed for student_dim=20, seed=0: unsupported operand type(s) for /: 'NoneType' and 'float'
2025-11-13 12:54:02,776 - INFO - Process 0: Completed experiment - student_dim=20, seed=0
2025-11-13 12:54:02,798 - ERROR - G&C failed for student_dim=50, seed=0: cannot access local variable 'gnc_loss_variance' where it is not associated with a value
2025-11-13 12:54:02,799 - ERROR - Traceback (most recent call last):
  File "/home/fodl/noacaspi/ssm_generalize/main.py", line 99, in process_worker
    mean_prior, gnc_gen_loss, variance_gnc = train_gnc(seed, student_dim, device, alpha_teacher, w_sequences,
                                             ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        args_dict['eps_train'], args_dict['gnc_num_samples'],
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        batch_size, False)
                                        ^^^^^^^^^^^^^^^^^^
  File "/home/fodl/noacaspi/ssm_generalize/training.py", line 259, in train_gnc
    gnc_loss_variance += torch.var(gen_loss[finite_mask])
    ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'gnc_loss_variance' where it is not associated with a value

2025-11-13 12:54:02,799 - INFO - Using adaptive scheduler with base_lr=None, beta=None, soft_const=None
2025-11-13 12:54:02,799 - INFO - Calling train_gd with scheduler_params: {'base_lr': None, 'beta': None, 'soft_const': None}
2025-11-13 12:54:02,800 - INFO - initial model: max A_j index: 43
2025-11-13 12:54:02,803 - ERROR - GD failed for student_dim=50, seed=0: unsupported operand type(s) for /: 'NoneType' and 'float'
2025-11-13 12:54:02,807 - INFO - Process 0: Completed experiment - student_dim=50, seed=0
2025-11-13 12:54:02,810 - INFO - initial model: max A_j index: 7
2025-11-13 12:54:02,821 - ERROR - G&C failed for student_dim=150, seed=2: cannot access local variable 'gnc_loss_variance' where it is not associated with a value
2025-11-13 12:54:02,822 - ERROR - Traceback (most recent call last):
  File "/home/fodl/noacaspi/ssm_generalize/main.py", line 99, in process_worker
    mean_prior, gnc_gen_loss, variance_gnc = train_gnc(seed, student_dim, device, alpha_teacher, w_sequences,
                                             ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        args_dict['eps_train'], args_dict['gnc_num_samples'],
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        batch_size, False)
                                        ^^^^^^^^^^^^^^^^^^
  File "/home/fodl/noacaspi/ssm_generalize/training.py", line 259, in train_gnc
    gnc_loss_variance += torch.var(gen_loss[finite_mask])
    ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'gnc_loss_variance' where it is not associated with a value

2025-11-13 12:54:02,822 - INFO - Using adaptive scheduler with base_lr=None, beta=None, soft_const=None
2025-11-13 12:54:02,822 - INFO - Calling train_gd with scheduler_params: {'base_lr': None, 'beta': None, 'soft_const': None}
2025-11-13 12:54:02,823 - INFO - initial model: max A_j index: 27
2025-11-13 12:54:02,826 - ERROR - GD failed for student_dim=150, seed=2: unsupported operand type(s) for /: 'NoneType' and 'float'
2025-11-13 12:54:02,832 - INFO - Process 2: Completed experiment - student_dim=150, seed=2
2025-11-13 12:54:02,836 - INFO - initial model: max A_j index: 0
2025-11-13 12:54:02,839 - ERROR - GD failed for student_dim=10, seed=3: unsupported operand type(s) for /: 'NoneType' and 'float'
2025-11-13 12:54:02,842 - INFO - Process 3: Completed experiment - student_dim=10, seed=3
2025-11-13 12:54:02,843 - ERROR - G&C failed for student_dim=100, seed=0: cannot access local variable 'gnc_loss_variance' where it is not associated with a value
2025-11-13 12:54:02,844 - ERROR - Traceback (most recent call last):
  File "/home/fodl/noacaspi/ssm_generalize/main.py", line 99, in process_worker
    mean_prior, gnc_gen_loss, variance_gnc = train_gnc(seed, student_dim, device, alpha_teacher, w_sequences,
                                             ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        args_dict['eps_train'], args_dict['gnc_num_samples'],
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        batch_size, False)
                                        ^^^^^^^^^^^^^^^^^^
  File "/home/fodl/noacaspi/ssm_generalize/training.py", line 259, in train_gnc
    gnc_loss_variance += torch.var(gen_loss[finite_mask])
    ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'gnc_loss_variance' where it is not associated with a value

2025-11-13 12:54:02,844 - INFO - Using adaptive scheduler with base_lr=None, beta=None, soft_const=None
2025-11-13 12:54:02,844 - INFO - Calling train_gd with scheduler_params: {'base_lr': None, 'beta': None, 'soft_const': None}
2025-11-13 12:54:02,845 - INFO - initial model: max A_j index: 59
2025-11-13 12:54:02,847 - ERROR - GD failed for student_dim=100, seed=0: unsupported operand type(s) for /: 'NoneType' and 'float'
2025-11-13 12:54:02,852 - INFO - Process 0: Completed experiment - student_dim=100, seed=0
2025-11-13 12:54:02,853 - ERROR - G&C failed for student_dim=20, seed=3: cannot access local variable 'gnc_loss_variance' where it is not associated with a value
2025-11-13 12:54:02,854 - ERROR - Traceback (most recent call last):
  File "/home/fodl/noacaspi/ssm_generalize/main.py", line 99, in process_worker
    mean_prior, gnc_gen_loss, variance_gnc = train_gnc(seed, student_dim, device, alpha_teacher, w_sequences,
                                             ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        args_dict['eps_train'], args_dict['gnc_num_samples'],
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        batch_size, False)
                                        ^^^^^^^^^^^^^^^^^^
  File "/home/fodl/noacaspi/ssm_generalize/training.py", line 259, in train_gnc
    gnc_loss_variance += torch.var(gen_loss[finite_mask])
    ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'gnc_loss_variance' where it is not associated with a value

2025-11-13 12:54:02,854 - INFO - Using adaptive scheduler with base_lr=None, beta=None, soft_const=None
2025-11-13 12:54:02,854 - INFO - Calling train_gd with scheduler_params: {'base_lr': None, 'beta': None, 'soft_const': None}
2025-11-13 12:54:02,855 - INFO - initial model: max A_j index: 14
2025-11-13 12:54:02,857 - ERROR - GD failed for student_dim=20, seed=3: unsupported operand type(s) for /: 'NoneType' and 'float'
2025-11-13 12:54:02,860 - INFO - Process 3: Completed experiment - student_dim=20, seed=3
2025-11-13 12:54:02,884 - ERROR - G&C failed for student_dim=50, seed=3: cannot access local variable 'gnc_loss_variance' where it is not associated with a value
2025-11-13 12:54:02,884 - ERROR - Traceback (most recent call last):
  File "/home/fodl/noacaspi/ssm_generalize/main.py", line 99, in process_worker
    mean_prior, gnc_gen_loss, variance_gnc = train_gnc(seed, student_dim, device, alpha_teacher, w_sequences,
                                             ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        args_dict['eps_train'], args_dict['gnc_num_samples'],
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        batch_size, False)
                                        ^^^^^^^^^^^^^^^^^^
  File "/home/fodl/noacaspi/ssm_generalize/training.py", line 259, in train_gnc
    gnc_loss_variance += torch.var(gen_loss[finite_mask])
    ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'gnc_loss_variance' where it is not associated with a value

2025-11-13 12:54:02,885 - INFO - Using adaptive scheduler with base_lr=None, beta=None, soft_const=None
2025-11-13 12:54:02,885 - INFO - Calling train_gd with scheduler_params: {'base_lr': None, 'beta': None, 'soft_const': None}
2025-11-13 12:54:02,886 - INFO - initial model: max A_j index: 30
2025-11-13 12:54:02,887 - ERROR - GD failed for student_dim=50, seed=3: unsupported operand type(s) for /: 'NoneType' and 'float'
2025-11-13 12:54:02,891 - INFO - Process 3: Completed experiment - student_dim=50, seed=3
2025-11-13 12:54:02,893 - ERROR - GD failed for student_dim=10, seed=1: unsupported operand type(s) for /: 'NoneType' and 'float'
2025-11-13 12:54:02,896 - INFO - Process 1: Completed experiment - student_dim=10, seed=1
2025-11-13 12:54:02,905 - ERROR - G&C failed for student_dim=150, seed=0: cannot access local variable 'gnc_loss_variance' where it is not associated with a value
2025-11-13 12:54:02,906 - ERROR - Traceback (most recent call last):
  File "/home/fodl/noacaspi/ssm_generalize/main.py", line 99, in process_worker
    mean_prior, gnc_gen_loss, variance_gnc = train_gnc(seed, student_dim, device, alpha_teacher, w_sequences,
                                             ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        args_dict['eps_train'], args_dict['gnc_num_samples'],
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        batch_size, False)
                                        ^^^^^^^^^^^^^^^^^^
  File "/home/fodl/noacaspi/ssm_generalize/training.py", line 259, in train_gnc
    gnc_loss_variance += torch.var(gen_loss[finite_mask])
    ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'gnc_loss_variance' where it is not associated with a value

2025-11-13 12:54:02,906 - INFO - Using adaptive scheduler with base_lr=None, beta=None, soft_const=None
2025-11-13 12:54:02,906 - INFO - Calling train_gd with scheduler_params: {'base_lr': None, 'beta': None, 'soft_const': None}
2025-11-13 12:54:02,907 - INFO - initial model: max A_j index: 59
2025-11-13 12:54:02,907 - ERROR - G&C failed for student_dim=20, seed=1: cannot access local variable 'gnc_loss_variance' where it is not associated with a value
2025-11-13 12:54:02,908 - ERROR - Traceback (most recent call last):
  File "/home/fodl/noacaspi/ssm_generalize/main.py", line 99, in process_worker
    mean_prior, gnc_gen_loss, variance_gnc = train_gnc(seed, student_dim, device, alpha_teacher, w_sequences,
                                             ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        args_dict['eps_train'], args_dict['gnc_num_samples'],
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        batch_size, False)
                                        ^^^^^^^^^^^^^^^^^^
  File "/home/fodl/noacaspi/ssm_generalize/training.py", line 259, in train_gnc
    gnc_loss_variance += torch.var(gen_loss[finite_mask])
    ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'gnc_loss_variance' where it is not associated with a value

2025-11-13 12:54:02,909 - INFO - Using adaptive scheduler with base_lr=None, beta=None, soft_const=None
2025-11-13 12:54:02,909 - INFO - Calling train_gd with scheduler_params: {'base_lr': None, 'beta': None, 'soft_const': None}
2025-11-13 12:54:02,909 - ERROR - GD failed for student_dim=150, seed=0: unsupported operand type(s) for /: 'NoneType' and 'float'
2025-11-13 12:54:02,910 - INFO - initial model: max A_j index: 10
2025-11-13 12:54:02,912 - ERROR - GD failed for student_dim=20, seed=1: unsupported operand type(s) for /: 'NoneType' and 'float'
2025-11-13 12:54:02,914 - INFO - Process 0: Completed experiment - student_dim=150, seed=0
2025-11-13 12:54:02,915 - INFO - Process 1: Completed experiment - student_dim=20, seed=1
2025-11-13 12:54:02,926 - ERROR - G&C failed for student_dim=100, seed=3: cannot access local variable 'gnc_loss_variance' where it is not associated with a value
2025-11-13 12:54:02,927 - ERROR - Traceback (most recent call last):
  File "/home/fodl/noacaspi/ssm_generalize/main.py", line 99, in process_worker
    mean_prior, gnc_gen_loss, variance_gnc = train_gnc(seed, student_dim, device, alpha_teacher, w_sequences,
                                             ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        args_dict['eps_train'], args_dict['gnc_num_samples'],
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        batch_size, False)
                                        ^^^^^^^^^^^^^^^^^^
  File "/home/fodl/noacaspi/ssm_generalize/training.py", line 259, in train_gnc
    gnc_loss_variance += torch.var(gen_loss[finite_mask])
    ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'gnc_loss_variance' where it is not associated with a value

2025-11-13 12:54:02,927 - INFO - Using adaptive scheduler with base_lr=None, beta=None, soft_const=None
2025-11-13 12:54:02,927 - INFO - Calling train_gd with scheduler_params: {'base_lr': None, 'beta': None, 'soft_const': None}
2025-11-13 12:54:02,928 - INFO - initial model: max A_j index: 30
2025-11-13 12:54:02,930 - ERROR - GD failed for student_dim=100, seed=3: unsupported operand type(s) for /: 'NoneType' and 'float'
2025-11-13 12:54:02,934 - ERROR - G&C failed for student_dim=300, seed=2: cannot access local variable 'gnc_loss_variance' where it is not associated with a value
2025-11-13 12:54:02,935 - INFO - Process 3: Completed experiment - student_dim=100, seed=3
2025-11-13 12:54:02,935 - ERROR - Traceback (most recent call last):
  File "/home/fodl/noacaspi/ssm_generalize/main.py", line 99, in process_worker
    mean_prior, gnc_gen_loss, variance_gnc = train_gnc(seed, student_dim, device, alpha_teacher, w_sequences,
                                             ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        args_dict['eps_train'], args_dict['gnc_num_samples'],
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        batch_size, False)
                                        ^^^^^^^^^^^^^^^^^^
  File "/home/fodl/noacaspi/ssm_generalize/training.py", line 259, in train_gnc
    gnc_loss_variance += torch.var(gen_loss[finite_mask])
    ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'gnc_loss_variance' where it is not associated with a value

2025-11-13 12:54:02,935 - INFO - Using adaptive scheduler with base_lr=None, beta=None, soft_const=None
2025-11-13 12:54:02,935 - INFO - Calling train_gd with scheduler_params: {'base_lr': None, 'beta': None, 'soft_const': None}
2025-11-13 12:54:02,936 - INFO - initial model: max A_j index: 27
2025-11-13 12:54:02,937 - ERROR - G&C failed for student_dim=50, seed=1: cannot access local variable 'gnc_loss_variance' where it is not associated with a value
2025-11-13 12:54:02,937 - ERROR - Traceback (most recent call last):
  File "/home/fodl/noacaspi/ssm_generalize/main.py", line 99, in process_worker
    mean_prior, gnc_gen_loss, variance_gnc = train_gnc(seed, student_dim, device, alpha_teacher, w_sequences,
                                             ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        args_dict['eps_train'], args_dict['gnc_num_samples'],
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        batch_size, False)
                                        ^^^^^^^^^^^^^^^^^^
  File "/home/fodl/noacaspi/ssm_generalize/training.py", line 259, in train_gnc
    gnc_loss_variance += torch.var(gen_loss[finite_mask])
    ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'gnc_loss_variance' where it is not associated with a value

2025-11-13 12:54:02,937 - INFO - Using adaptive scheduler with base_lr=None, beta=None, soft_const=None
2025-11-13 12:54:02,937 - INFO - Calling train_gd with scheduler_params: {'base_lr': None, 'beta': None, 'soft_const': None}
2025-11-13 12:54:02,938 - INFO - initial model: max A_j index: 39
2025-11-13 12:54:02,938 - ERROR - GD failed for student_dim=300, seed=2: unsupported operand type(s) for /: 'NoneType' and 'float'
2025-11-13 12:54:02,941 - ERROR - GD failed for student_dim=50, seed=1: unsupported operand type(s) for /: 'NoneType' and 'float'
2025-11-13 12:54:02,946 - INFO - Process 2: Completed experiment - student_dim=300, seed=2
2025-11-13 12:54:02,946 - INFO - Process 1: Completed experiment - student_dim=50, seed=1
2025-11-13 12:54:02,947 - INFO - Process 2 completed on GPU 2
2025-11-13 12:54:02,982 - ERROR - G&C failed for student_dim=100, seed=1: cannot access local variable 'gnc_loss_variance' where it is not associated with a value
2025-11-13 12:54:02,982 - ERROR - Traceback (most recent call last):
  File "/home/fodl/noacaspi/ssm_generalize/main.py", line 99, in process_worker
    mean_prior, gnc_gen_loss, variance_gnc = train_gnc(seed, student_dim, device, alpha_teacher, w_sequences,
                                             ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        args_dict['eps_train'], args_dict['gnc_num_samples'],
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        batch_size, False)
                                        ^^^^^^^^^^^^^^^^^^
  File "/home/fodl/noacaspi/ssm_generalize/training.py", line 259, in train_gnc
    gnc_loss_variance += torch.var(gen_loss[finite_mask])
    ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'gnc_loss_variance' where it is not associated with a value

2025-11-13 12:54:02,983 - INFO - Using adaptive scheduler with base_lr=None, beta=None, soft_const=None
2025-11-13 12:54:02,983 - INFO - Calling train_gd with scheduler_params: {'base_lr': None, 'beta': None, 'soft_const': None}
2025-11-13 12:54:02,984 - INFO - initial model: max A_j index: 44
2025-11-13 12:54:02,986 - ERROR - GD failed for student_dim=100, seed=1: unsupported operand type(s) for /: 'NoneType' and 'float'
2025-11-13 12:54:02,987 - ERROR - G&C failed for student_dim=150, seed=3: cannot access local variable 'gnc_loss_variance' where it is not associated with a value
2025-11-13 12:54:02,987 - ERROR - Traceback (most recent call last):
  File "/home/fodl/noacaspi/ssm_generalize/main.py", line 99, in process_worker
    mean_prior, gnc_gen_loss, variance_gnc = train_gnc(seed, student_dim, device, alpha_teacher, w_sequences,
                                             ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        args_dict['eps_train'], args_dict['gnc_num_samples'],
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        batch_size, False)
                                        ^^^^^^^^^^^^^^^^^^
  File "/home/fodl/noacaspi/ssm_generalize/training.py", line 259, in train_gnc
    gnc_loss_variance += torch.var(gen_loss[finite_mask])
    ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'gnc_loss_variance' where it is not associated with a value

2025-11-13 12:54:02,987 - INFO - Using adaptive scheduler with base_lr=None, beta=None, soft_const=None
2025-11-13 12:54:02,988 - INFO - Calling train_gd with scheduler_params: {'base_lr': None, 'beta': None, 'soft_const': None}
2025-11-13 12:54:02,988 - INFO - initial model: max A_j index: 143
2025-11-13 12:54:02,990 - ERROR - GD failed for student_dim=150, seed=3: unsupported operand type(s) for /: 'NoneType' and 'float'
2025-11-13 12:54:02,992 - INFO - Process 1: Completed experiment - student_dim=100, seed=1
2025-11-13 12:54:02,995 - INFO - Process 3: Completed experiment - student_dim=150, seed=3
2025-11-13 12:54:03,018 - ERROR - G&C failed for student_dim=300, seed=0: cannot access local variable 'gnc_loss_variance' where it is not associated with a value
2025-11-13 12:54:03,018 - ERROR - Traceback (most recent call last):
  File "/home/fodl/noacaspi/ssm_generalize/main.py", line 99, in process_worker
    mean_prior, gnc_gen_loss, variance_gnc = train_gnc(seed, student_dim, device, alpha_teacher, w_sequences,
                                             ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        args_dict['eps_train'], args_dict['gnc_num_samples'],
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        batch_size, False)
                                        ^^^^^^^^^^^^^^^^^^
  File "/home/fodl/noacaspi/ssm_generalize/training.py", line 259, in train_gnc
    gnc_loss_variance += torch.var(gen_loss[finite_mask])
    ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'gnc_loss_variance' where it is not associated with a value

2025-11-13 12:54:03,019 - INFO - Using adaptive scheduler with base_lr=None, beta=None, soft_const=None
2025-11-13 12:54:03,019 - INFO - Calling train_gd with scheduler_params: {'base_lr': None, 'beta': None, 'soft_const': None}
2025-11-13 12:54:03,020 - INFO - initial model: max A_j index: 59
2025-11-13 12:54:03,021 - ERROR - GD failed for student_dim=300, seed=0: unsupported operand type(s) for /: 'NoneType' and 'float'
2025-11-13 12:54:03,029 - INFO - Process 0: Completed experiment - student_dim=300, seed=0
2025-11-13 12:54:03,031 - INFO - Process 0 completed on GPU 0
2025-11-13 12:54:03,046 - ERROR - G&C failed for student_dim=150, seed=1: cannot access local variable 'gnc_loss_variance' where it is not associated with a value
2025-11-13 12:54:03,047 - ERROR - Traceback (most recent call last):
  File "/home/fodl/noacaspi/ssm_generalize/main.py", line 99, in process_worker
    mean_prior, gnc_gen_loss, variance_gnc = train_gnc(seed, student_dim, device, alpha_teacher, w_sequences,
                                             ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        args_dict['eps_train'], args_dict['gnc_num_samples'],
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        batch_size, False)
                                        ^^^^^^^^^^^^^^^^^^
  File "/home/fodl/noacaspi/ssm_generalize/training.py", line 259, in train_gnc
    gnc_loss_variance += torch.var(gen_loss[finite_mask])
    ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'gnc_loss_variance' where it is not associated with a value

2025-11-13 12:54:03,047 - INFO - Using adaptive scheduler with base_lr=None, beta=None, soft_const=None
2025-11-13 12:54:03,047 - INFO - Calling train_gd with scheduler_params: {'base_lr': None, 'beta': None, 'soft_const': None}
2025-11-13 12:54:03,048 - INFO - initial model: max A_j index: 120
2025-11-13 12:54:03,051 - ERROR - GD failed for student_dim=150, seed=1: unsupported operand type(s) for /: 'NoneType' and 'float'
2025-11-13 12:54:03,057 - INFO - Process 1: Completed experiment - student_dim=150, seed=1
2025-11-13 12:54:03,098 - ERROR - G&C failed for student_dim=300, seed=3: cannot access local variable 'gnc_loss_variance' where it is not associated with a value
2025-11-13 12:54:03,099 - ERROR - Traceback (most recent call last):
  File "/home/fodl/noacaspi/ssm_generalize/main.py", line 99, in process_worker
    mean_prior, gnc_gen_loss, variance_gnc = train_gnc(seed, student_dim, device, alpha_teacher, w_sequences,
                                             ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        args_dict['eps_train'], args_dict['gnc_num_samples'],
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        batch_size, False)
                                        ^^^^^^^^^^^^^^^^^^
  File "/home/fodl/noacaspi/ssm_generalize/training.py", line 259, in train_gnc
    gnc_loss_variance += torch.var(gen_loss[finite_mask])
    ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'gnc_loss_variance' where it is not associated with a value

2025-11-13 12:54:03,099 - INFO - Using adaptive scheduler with base_lr=None, beta=None, soft_const=None
2025-11-13 12:54:03,099 - INFO - Calling train_gd with scheduler_params: {'base_lr': None, 'beta': None, 'soft_const': None}
2025-11-13 12:54:03,100 - INFO - initial model: max A_j index: 159
2025-11-13 12:54:03,101 - ERROR - GD failed for student_dim=300, seed=3: unsupported operand type(s) for /: 'NoneType' and 'float'
2025-11-13 12:54:03,109 - INFO - Process 3: Completed experiment - student_dim=300, seed=3
2025-11-13 12:54:03,110 - INFO - Process 3 completed on GPU 3
2025-11-13 12:54:03,159 - ERROR - G&C failed for student_dim=300, seed=1: cannot access local variable 'gnc_loss_variance' where it is not associated with a value
2025-11-13 12:54:03,160 - ERROR - Traceback (most recent call last):
  File "/home/fodl/noacaspi/ssm_generalize/main.py", line 99, in process_worker
    mean_prior, gnc_gen_loss, variance_gnc = train_gnc(seed, student_dim, device, alpha_teacher, w_sequences,
                                             ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        args_dict['eps_train'], args_dict['gnc_num_samples'],
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        batch_size, False)
                                        ^^^^^^^^^^^^^^^^^^
  File "/home/fodl/noacaspi/ssm_generalize/training.py", line 259, in train_gnc
    gnc_loss_variance += torch.var(gen_loss[finite_mask])
    ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'gnc_loss_variance' where it is not associated with a value

2025-11-13 12:54:03,160 - INFO - Using adaptive scheduler with base_lr=None, beta=None, soft_const=None
2025-11-13 12:54:03,161 - INFO - Calling train_gd with scheduler_params: {'base_lr': None, 'beta': None, 'soft_const': None}
2025-11-13 12:54:03,161 - INFO - initial model: max A_j index: 120
2025-11-13 12:54:03,164 - ERROR - GD failed for student_dim=300, seed=1: unsupported operand type(s) for /: 'NoneType' and 'float'
2025-11-13 12:54:03,171 - INFO - Process 1: Completed experiment - student_dim=300, seed=1
2025-11-13 12:54:03,173 - INFO - Process 1 completed on GPU 1
2025-11-13 12:54:06,372 - INFO - Process 2 completed
2025-11-13 12:54:07,373 - INFO - Process 0 completed
