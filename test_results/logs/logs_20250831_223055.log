2025-08-31 22:30:55,274 - INFO - Args: Namespace(num_seeds=5, seeds=[21997, 9920, 74050, 54077, 81434], sequence_length=5, num_sequences=2, student_dims=[150, 175, 200, 225, 250, 275], eps_train=1e-05, w_that_minimizes_loss=False, gnc=True, gnc_num_samples=100000000, gnc_batch_size=1000000, gd=True, gd_lr=0.001, gd_epochs=10000, gd_init_scale=0.01, gd_optimizer='adam', gd_scheduler=None, gd_scheduler_params='{}', exp_gamma=None, step_size=None, step_gamma=None, cosine_eta_min=None, gd_init_type='regular', config=None, results_dir=PosixPath('test_results/results'), figures_dir=PosixPath('test_results/figures'), checkpoint_dir=PosixPath('test_results/checkpoints'), checkpoint_interval=3600, resume_from_checkpoint=False, log_dir=PosixPath('test_results/logs'), max_gpus=4, log_file=PosixPath('test_results/logs/logs_20250831_223055.log'))
2025-08-31 22:30:55,275 - INFO - Using custom seeds: [21997, 9920, 74050, 54077, 81434]
2025-08-31 22:30:55,477 - INFO - Using GPUs: [0, 1, 2, 3]
2025-08-31 22:30:55,477 - INFO - Starting 4 processes on 4 GPUs
2025-08-31 22:30:59,326 - INFO - Process 0 started on GPU 0, processing seeds [21997, 9920]
2025-08-31 22:30:59,606 - INFO - Process 1 started on GPU 1, processing seeds [74050]
2025-08-31 22:30:59,655 - INFO - Process 3 started on GPU 3, processing seeds [81434]
2025-08-31 22:30:59,802 - INFO - for seed 74050, alpha_teacher=tensor([0.5385], device='cuda:1'), generated 2 sequences
2025-08-31 22:30:59,802 - INFO - Process 1: Starting experiment - student_dim=150, seed=74050
2025-08-31 22:30:59,857 - INFO - for seed 81434, alpha_teacher=tensor([0.3650], device='cuda:3'), generated 2 sequences
2025-08-31 22:30:59,857 - INFO - for seed 21997, alpha_teacher=tensor([0.4810], device='cuda:0'), generated 2 sequences
2025-08-31 22:30:59,857 - INFO - Process 3: Starting experiment - student_dim=150, seed=81434
2025-08-31 22:30:59,857 - INFO - Process 0: Starting experiment - student_dim=150, seed=21997
2025-08-31 22:30:59,911 - INFO - Process 2 started on GPU 2, processing seeds [54077]
2025-08-31 22:31:00,092 - INFO - for seed 54077, alpha_teacher=tensor([0.4614], device='cuda:2'), generated 2 sequences
2025-08-31 22:31:00,093 - INFO - Process 2: Starting experiment - student_dim=150, seed=54077
2025-08-31 22:40:23,224 - WARNING - No GNC sensing losses for student dimension 150 seed 21997
2025-08-31 22:40:24,984 - INFO - No scheduler or scheduler type 'None', using empty params
2025-08-31 22:40:24,985 - INFO - Calling train_gd with scheduler_params: {}
2025-08-31 22:40:29,100 - INFO - initial model: max A_j index: 30
2025-08-31 22:41:06,587 - WARNING - No GNC sensing losses for student dimension 150 seed 54077
2025-08-31 22:41:06,781 - INFO - No scheduler or scheduler type 'None', using empty params
2025-08-31 22:41:06,781 - INFO - Calling train_gd with scheduler_params: {}
2025-08-31 22:41:08,661 - INFO - initial model: max A_j index: 140
2025-08-31 22:41:20,486 - INFO - final model: max A_j index: 30, max A_j value: 0.17341820895671844, alpha_teacher: tensor([0.4810], device='cuda:0')
2025-08-31 22:41:20,552 - INFO - largest 10 A_j values: tensor([0.1734, 0.1314, 0.1279, 0.1252, 0.1095, 0.1047, 0.0999, 0.0983, 0.0905,
        0.0901], device='cuda:0', grad_fn=<TopkBackward0>)
2025-08-31 22:41:20,553 - INFO - number of values below 0.01: 89
2025-08-31 22:41:20,553 - INFO - number of values between 0.01 and 0.1: 55
2025-08-31 22:41:20,553 - INFO - number of values between 0.1 and 0.3: 6
2025-08-31 22:41:20,553 - INFO - number of values larger than 0.3: 0
2025-08-31 22:41:20,553 - INFO - train loss is 5.696848548453204e-11
2025-08-31 22:41:20,554 - INFO - impulse response loss is 0.023130614310503006
2025-08-31 22:41:20,557 - INFO - Process 0: Completed experiment - student_dim=150, seed=21997
2025-08-31 22:41:34,339 - INFO - final model: max A_j index: 140, max A_j value: 0.1107994094491005, alpha_teacher: tensor([0.4614], device='cuda:2')
2025-08-31 22:41:34,392 - INFO - largest 10 A_j values: tensor([0.1108, 0.0930, 0.0915, 0.0869, 0.0840, 0.0809, 0.0802, 0.0767, 0.0733,
        0.0672], device='cuda:2', grad_fn=<TopkBackward0>)
2025-08-31 22:41:34,392 - INFO - number of values below 0.01: 91
2025-08-31 22:41:34,392 - INFO - number of values between 0.01 and 0.1: 58
2025-08-31 22:41:34,393 - INFO - number of values between 0.1 and 0.3: 1
2025-08-31 22:41:34,393 - INFO - number of values larger than 0.3: 0
2025-08-31 22:41:34,393 - INFO - train loss is 1.3523308552976232e-06
2025-08-31 22:41:34,393 - INFO - impulse response loss is 0.015378045849502087
2025-08-31 22:41:34,396 - INFO - Process 2: Completed experiment - student_dim=150, seed=54077
2025-08-31 22:41:34,613 - WARNING - No GNC sensing losses for student dimension 150 seed 81434
2025-08-31 22:41:34,793 - INFO - No scheduler or scheduler type 'None', using empty params
2025-08-31 22:41:34,793 - INFO - Calling train_gd with scheduler_params: {}
2025-08-31 22:41:38,000 - INFO - initial model: max A_j index: 37
2025-08-31 22:42:28,987 - INFO - final model: max A_j index: 37, max A_j value: 0.09875078499317169, alpha_teacher: tensor([0.3650], device='cuda:3')
2025-08-31 22:42:29,052 - INFO - largest 10 A_j values: tensor([0.0988, 0.0975, 0.0855, 0.0845, 0.0843, 0.0807, 0.0774, 0.0687, 0.0628,
        0.0618], device='cuda:3', grad_fn=<TopkBackward0>)
2025-08-31 22:42:29,052 - INFO - number of values below 0.01: 91
2025-08-31 22:42:29,052 - INFO - number of values between 0.01 and 0.1: 59
2025-08-31 22:42:29,052 - INFO - number of values between 0.1 and 0.3: 0
2025-08-31 22:42:29,053 - INFO - number of values larger than 0.3: 0
2025-08-31 22:42:29,053 - INFO - train loss is 6.245268746596366e-09
2025-08-31 22:42:29,053 - INFO - impulse response loss is 0.008446479216217995
2025-08-31 22:42:29,055 - INFO - Process 3: Completed experiment - student_dim=150, seed=81434
2025-08-31 22:44:56,686 - WARNING - No GNC sensing losses for student dimension 150 seed 74050
2025-08-31 22:44:56,905 - INFO - No scheduler or scheduler type 'None', using empty params
2025-08-31 22:44:56,905 - INFO - Calling train_gd with scheduler_params: {}
2025-08-31 22:45:00,464 - INFO - initial model: max A_j index: 82
2025-08-31 22:45:49,708 - INFO - final model: max A_j index: 82, max A_j value: 0.12133360654115677, alpha_teacher: tensor([0.5385], device='cuda:1')
2025-08-31 22:45:49,772 - INFO - largest 10 A_j values: tensor([0.1213, 0.0914, 0.0913, 0.0822, 0.0806, 0.0798, 0.0798, 0.0789, 0.0721,
        0.0710], device='cuda:1', grad_fn=<TopkBackward0>)
2025-08-31 22:45:49,773 - INFO - number of values below 0.01: 88
2025-08-31 22:45:49,773 - INFO - number of values between 0.01 and 0.1: 61
2025-08-31 22:45:49,774 - INFO - number of values between 0.1 and 0.3: 1
2025-08-31 22:45:49,774 - INFO - number of values larger than 0.3: 0
2025-08-31 22:45:49,774 - INFO - train loss is 0.0
2025-08-31 22:45:49,774 - INFO - impulse response loss is 0.05344005674123764
2025-08-31 22:45:49,777 - INFO - Process 1: Completed experiment - student_dim=150, seed=74050
2025-08-31 22:52:23,413 - WARNING - No GNC sensing losses for student dimension 175 seed 21997
2025-08-31 22:52:23,421 - INFO - No scheduler or scheduler type 'None', using empty params
2025-08-31 22:52:23,421 - INFO - Calling train_gd with scheduler_params: {}
2025-08-31 22:52:23,422 - INFO - initial model: max A_j index: 30
2025-08-31 22:53:13,036 - INFO - final model: max A_j index: 30, max A_j value: 0.15955202281475067, alpha_teacher: tensor([0.4810], device='cuda:0')
2025-08-31 22:53:13,038 - INFO - largest 10 A_j values: tensor([0.1596, 0.1345, 0.1222, 0.1167, 0.1027, 0.0984, 0.0941, 0.0927, 0.0857,
        0.0853], device='cuda:0', grad_fn=<TopkBackward0>)
2025-08-31 22:53:13,039 - INFO - number of values below 0.01: 104
2025-08-31 22:53:13,040 - INFO - number of values between 0.01 and 0.1: 66
2025-08-31 22:53:13,040 - INFO - number of values between 0.1 and 0.3: 5
2025-08-31 22:53:13,040 - INFO - number of values larger than 0.3: 0
2025-08-31 22:53:13,041 - INFO - train loss is 2.3759032075076902e-08
2025-08-31 22:53:13,041 - INFO - impulse response loss is 0.025597721338272095
2025-08-31 22:53:13,052 - INFO - Process 0: Completed experiment - student_dim=175, seed=21997
2025-08-31 22:53:30,378 - WARNING - No GNC sensing losses for student dimension 175 seed 54077
2025-08-31 22:53:30,381 - INFO - No scheduler or scheduler type 'None', using empty params
2025-08-31 22:53:30,382 - INFO - Calling train_gd with scheduler_params: {}
2025-08-31 22:53:30,383 - INFO - initial model: max A_j index: 12
2025-08-31 22:53:45,463 - INFO - final model: max A_j index: 12, max A_j value: 0.09065370261669159, alpha_teacher: tensor([0.4614], device='cuda:2')
2025-08-31 22:53:45,464 - INFO - largest 10 A_j values: tensor([0.0907, 0.0892, 0.0847, 0.0819, 0.0798, 0.0789, 0.0782, 0.0748, 0.0714,
        0.0661], device='cuda:2', grad_fn=<TopkBackward0>)
2025-08-31 22:53:45,464 - INFO - number of values below 0.01: 106
2025-08-31 22:53:45,464 - INFO - number of values between 0.01 and 0.1: 69
2025-08-31 22:53:45,464 - INFO - number of values between 0.1 and 0.3: 0
2025-08-31 22:53:45,464 - INFO - number of values larger than 0.3: 0
2025-08-31 22:53:45,464 - INFO - train loss is 6.753689945071528e-07
2025-08-31 22:53:45,464 - INFO - impulse response loss is 0.015516504645347595
2025-08-31 22:53:45,469 - INFO - Process 2: Completed experiment - student_dim=175, seed=54077
2025-08-31 22:55:24,974 - WARNING - No GNC sensing losses for student dimension 175 seed 81434
2025-08-31 22:55:24,978 - INFO - No scheduler or scheduler type 'None', using empty params
2025-08-31 22:55:24,978 - INFO - Calling train_gd with scheduler_params: {}
2025-08-31 22:55:24,978 - INFO - initial model: max A_j index: 161
2025-08-31 22:55:46,336 - INFO - final model: max A_j index: 161, max A_j value: 0.12331981956958771, alpha_teacher: tensor([0.3650], device='cuda:3')
2025-08-31 22:55:46,337 - INFO - largest 10 A_j values: tensor([0.1233, 0.0931, 0.0855, 0.0844, 0.0768, 0.0741, 0.0733, 0.0731, 0.0713,
        0.0700], device='cuda:3', grad_fn=<TopkBackward0>)
2025-08-31 22:55:46,337 - INFO - number of values below 0.01: 116
2025-08-31 22:55:46,337 - INFO - number of values between 0.01 and 0.1: 58
2025-08-31 22:55:46,338 - INFO - number of values between 0.1 and 0.3: 1
2025-08-31 22:55:46,338 - INFO - number of values larger than 0.3: 0
2025-08-31 22:55:46,338 - INFO - train loss is 4.673202103067098e-11
2025-08-31 22:55:46,338 - INFO - impulse response loss is 0.007933239452540874
2025-08-31 22:55:46,342 - INFO - Process 3: Completed experiment - student_dim=175, seed=81434
2025-08-31 23:02:59,977 - WARNING - No GNC sensing losses for student dimension 175 seed 74050
2025-08-31 23:02:59,982 - INFO - No scheduler or scheduler type 'None', using empty params
2025-08-31 23:02:59,982 - INFO - Calling train_gd with scheduler_params: {}
2025-08-31 23:02:59,983 - INFO - initial model: max A_j index: 82
2025-08-31 23:03:41,913 - INFO - final model: max A_j index: 82, max A_j value: 0.11448543518781662, alpha_teacher: tensor([0.5385], device='cuda:1')
2025-08-31 23:03:41,915 - INFO - largest 10 A_j values: tensor([0.1145, 0.0859, 0.0858, 0.0772, 0.0757, 0.0749, 0.0749, 0.0749, 0.0740,
        0.0669], device='cuda:1', grad_fn=<TopkBackward0>)
2025-08-31 23:03:41,915 - INFO - number of values below 0.01: 99
2025-08-31 23:03:41,915 - INFO - number of values between 0.01 and 0.1: 75
2025-08-31 23:03:41,915 - INFO - number of values between 0.1 and 0.3: 1
2025-08-31 23:03:41,915 - INFO - number of values larger than 0.3: 0
2025-08-31 23:03:41,915 - INFO - train loss is 6.102729432910792e-11
2025-08-31 23:03:41,915 - INFO - impulse response loss is 0.053834181278944016
2025-08-31 23:03:41,920 - INFO - Process 1: Completed experiment - student_dim=175, seed=74050
2025-08-31 23:05:55,413 - WARNING - No GNC sensing losses for student dimension 200 seed 21997
2025-08-31 23:05:55,417 - INFO - No scheduler or scheduler type 'None', using empty params
2025-08-31 23:05:55,417 - INFO - Calling train_gd with scheduler_params: {}
2025-08-31 23:05:55,418 - INFO - initial model: max A_j index: 30
2025-08-31 23:06:45,348 - INFO - final model: max A_j index: 30, max A_j value: 0.14002211391925812, alpha_teacher: tensor([0.4810], device='cuda:0')
2025-08-31 23:06:45,351 - INFO - largest 10 A_j values: tensor([0.1400, 0.1179, 0.1082, 0.1070, 0.1021, 0.0970, 0.0912, 0.0896, 0.0858,
        0.0819], device='cuda:0', grad_fn=<TopkBackward0>)
2025-08-31 23:06:45,352 - INFO - number of values below 0.01: 118
2025-08-31 23:06:45,352 - INFO - number of values between 0.01 and 0.1: 77
2025-08-31 23:06:45,353 - INFO - number of values between 0.1 and 0.3: 5
2025-08-31 23:06:45,353 - INFO - number of values larger than 0.3: 0
2025-08-31 23:06:45,353 - INFO - train loss is 8.51166359616684e-12
2025-08-31 23:06:45,353 - INFO - impulse response loss is 0.027529995888471603
2025-08-31 23:06:45,366 - INFO - Process 0: Completed experiment - student_dim=200, seed=21997
2025-08-31 23:06:49,508 - ERROR - G&C failed for student_dim=225, seed=21997: CUDA out of memory. Tried to allocate 3.35 GiB. GPU 0 has a total capacity of 10.75 GiB of which 2.96 GiB is free. Including non-PyTorch memory, this process has 7.79 GiB memory in use. Of the allocated memory 4.21 GiB is allocated by PyTorch, and 3.35 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-08-31 23:06:49,513 - ERROR - Traceback (most recent call last):
  File "/home/fodl/noacaspi/ssm_generalize/main.py", line 101, in process_worker
    mean_prior, gnc_gen_loss = train_gnc(seed, student_dim, device, alpha_teacher, w_sequences,
                               ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        args_dict['eps_train'], args_dict['gnc_num_samples'],
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        batch_size
                                        ^^^^^^^^^^
                                        )
                                        ^
  File "/home/fodl/noacaspi/ssm_generalize/training.py", line 156, in train_gnc
    train_losses, gen_losses = get_losses(students, w, alpha_teacher)
                               ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/fodl/noacaspi/ssm_generalize/losses.py", line 45, in get_losses
    A_pows = torch.cumprod(X, dim=2)
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.35 GiB. GPU 0 has a total capacity of 10.75 GiB of which 2.96 GiB is free. Including non-PyTorch memory, this process has 7.79 GiB memory in use. Of the allocated memory 4.21 GiB is allocated by PyTorch, and 3.35 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2025-08-31 23:06:49,513 - INFO - No scheduler or scheduler type 'None', using empty params
2025-08-31 23:06:49,513 - INFO - Calling train_gd with scheduler_params: {}
2025-08-31 23:06:49,514 - INFO - initial model: max A_j index: 30
2025-08-31 23:07:29,252 - WARNING - No GNC sensing losses for student dimension 200 seed 54077
2025-08-31 23:07:29,255 - INFO - No scheduler or scheduler type 'None', using empty params
2025-08-31 23:07:29,255 - INFO - Calling train_gd with scheduler_params: {}
2025-08-31 23:07:29,256 - INFO - initial model: max A_j index: 12
2025-08-31 23:07:30,553 - INFO - final model: max A_j index: 30, max A_j value: 0.13641102612018585, alpha_teacher: tensor([0.4810], device='cuda:0')
2025-08-31 23:07:30,556 - INFO - largest 10 A_j values: tensor([0.1364, 0.1155, 0.1127, 0.1052, 0.1006, 0.0958, 0.0887, 0.0852, 0.0841,
        0.0815], device='cuda:0', grad_fn=<TopkBackward0>)
2025-08-31 23:07:30,557 - INFO - number of values below 0.01: 136
2025-08-31 23:07:30,557 - INFO - number of values between 0.01 and 0.1: 84
2025-08-31 23:07:30,558 - INFO - number of values between 0.1 and 0.3: 5
2025-08-31 23:07:30,558 - INFO - number of values larger than 0.3: 0
2025-08-31 23:07:30,558 - INFO - train loss is 1.4482944621363458e-08
2025-08-31 23:07:30,559 - INFO - impulse response loss is 0.0277993306517601
2025-08-31 23:07:30,573 - INFO - Process 0: Completed experiment - student_dim=225, seed=21997
2025-08-31 23:07:35,221 - ERROR - G&C failed for student_dim=250, seed=21997: CUDA out of memory. Tried to allocate 3.73 GiB. GPU 0 has a total capacity of 10.75 GiB of which 2.12 GiB is free. Including non-PyTorch memory, this process has 8.63 GiB memory in use. Of the allocated memory 4.68 GiB is allocated by PyTorch, and 3.73 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-08-31 23:07:35,222 - ERROR - Traceback (most recent call last):
  File "/home/fodl/noacaspi/ssm_generalize/main.py", line 101, in process_worker
    mean_prior, gnc_gen_loss = train_gnc(seed, student_dim, device, alpha_teacher, w_sequences,
                               ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        args_dict['eps_train'], args_dict['gnc_num_samples'],
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        batch_size
                                        ^^^^^^^^^^
                                        )
                                        ^
  File "/home/fodl/noacaspi/ssm_generalize/training.py", line 156, in train_gnc
    train_losses, gen_losses = get_losses(students, w, alpha_teacher)
                               ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/fodl/noacaspi/ssm_generalize/losses.py", line 45, in get_losses
    A_pows = torch.cumprod(X, dim=2)
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.73 GiB. GPU 0 has a total capacity of 10.75 GiB of which 2.12 GiB is free. Including non-PyTorch memory, this process has 8.63 GiB memory in use. Of the allocated memory 4.68 GiB is allocated by PyTorch, and 3.73 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2025-08-31 23:07:35,223 - INFO - No scheduler or scheduler type 'None', using empty params
2025-08-31 23:07:35,223 - INFO - Calling train_gd with scheduler_params: {}
2025-08-31 23:07:35,223 - INFO - initial model: max A_j index: 30
2025-08-31 23:07:44,405 - INFO - final model: max A_j index: 12, max A_j value: 0.084206223487854, alpha_teacher: tensor([0.4614], device='cuda:2')
2025-08-31 23:07:44,406 - INFO - largest 10 A_j values: tensor([0.0842, 0.0829, 0.0787, 0.0782, 0.0761, 0.0742, 0.0733, 0.0727, 0.0695,
        0.0664], device='cuda:2', grad_fn=<TopkBackward0>)
2025-08-31 23:07:44,406 - INFO - number of values below 0.01: 125
2025-08-31 23:07:44,406 - INFO - number of values between 0.01 and 0.1: 75
2025-08-31 23:07:44,406 - INFO - number of values between 0.1 and 0.3: 0
2025-08-31 23:07:44,406 - INFO - number of values larger than 0.3: 0
2025-08-31 23:07:44,407 - INFO - train loss is 1.7203412305821786e-11
2025-08-31 23:07:44,407 - INFO - impulse response loss is 0.015676898881793022
2025-08-31 23:07:44,412 - INFO - Process 2: Completed experiment - student_dim=200, seed=54077
2025-08-31 23:07:48,758 - ERROR - G&C failed for student_dim=225, seed=54077: CUDA out of memory. Tried to allocate 3.35 GiB. GPU 2 has a total capacity of 10.75 GiB of which 2.96 GiB is free. Including non-PyTorch memory, this process has 7.79 GiB memory in use. Of the allocated memory 4.21 GiB is allocated by PyTorch, and 3.35 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-08-31 23:07:48,762 - ERROR - Traceback (most recent call last):
  File "/home/fodl/noacaspi/ssm_generalize/main.py", line 101, in process_worker
    mean_prior, gnc_gen_loss = train_gnc(seed, student_dim, device, alpha_teacher, w_sequences,
                               ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        args_dict['eps_train'], args_dict['gnc_num_samples'],
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        batch_size
                                        ^^^^^^^^^^
                                        )
                                        ^
  File "/home/fodl/noacaspi/ssm_generalize/training.py", line 156, in train_gnc
    train_losses, gen_losses = get_losses(students, w, alpha_teacher)
                               ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/fodl/noacaspi/ssm_generalize/losses.py", line 45, in get_losses
    A_pows = torch.cumprod(X, dim=2)
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.35 GiB. GPU 2 has a total capacity of 10.75 GiB of which 2.96 GiB is free. Including non-PyTorch memory, this process has 7.79 GiB memory in use. Of the allocated memory 4.21 GiB is allocated by PyTorch, and 3.35 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2025-08-31 23:07:48,762 - INFO - No scheduler or scheduler type 'None', using empty params
2025-08-31 23:07:48,762 - INFO - Calling train_gd with scheduler_params: {}
2025-08-31 23:07:48,763 - INFO - initial model: max A_j index: 12
2025-08-31 23:08:03,932 - INFO - final model: max A_j index: 12, max A_j value: 0.0827031284570694, alpha_teacher: tensor([0.4614], device='cuda:2')
2025-08-31 23:08:03,933 - INFO - largest 10 A_j values: tensor([0.0827, 0.0814, 0.0773, 0.0768, 0.0748, 0.0729, 0.0720, 0.0714, 0.0683,
        0.0653], device='cuda:2', grad_fn=<TopkBackward0>)
2025-08-31 23:08:03,933 - INFO - number of values below 0.01: 144
2025-08-31 23:08:03,934 - INFO - number of values between 0.01 and 0.1: 81
2025-08-31 23:08:03,934 - INFO - number of values between 0.1 and 0.3: 0
2025-08-31 23:08:03,934 - INFO - number of values larger than 0.3: 0
2025-08-31 23:08:03,934 - INFO - train loss is 0.0002267448726342991
2025-08-31 23:08:03,934 - INFO - impulse response loss is 0.015894154086709023
2025-08-31 23:08:03,944 - INFO - Process 2: Completed experiment - student_dim=225, seed=54077
2025-08-31 23:08:08,814 - ERROR - G&C failed for student_dim=250, seed=54077: CUDA out of memory. Tried to allocate 3.73 GiB. GPU 2 has a total capacity of 10.75 GiB of which 2.12 GiB is free. Including non-PyTorch memory, this process has 8.63 GiB memory in use. Of the allocated memory 4.68 GiB is allocated by PyTorch, and 3.73 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-08-31 23:08:08,815 - ERROR - Traceback (most recent call last):
  File "/home/fodl/noacaspi/ssm_generalize/main.py", line 101, in process_worker
    mean_prior, gnc_gen_loss = train_gnc(seed, student_dim, device, alpha_teacher, w_sequences,
                               ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        args_dict['eps_train'], args_dict['gnc_num_samples'],
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        batch_size
                                        ^^^^^^^^^^
                                        )
                                        ^
  File "/home/fodl/noacaspi/ssm_generalize/training.py", line 156, in train_gnc
    train_losses, gen_losses = get_losses(students, w, alpha_teacher)
                               ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/fodl/noacaspi/ssm_generalize/losses.py", line 45, in get_losses
    A_pows = torch.cumprod(X, dim=2)
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.73 GiB. GPU 2 has a total capacity of 10.75 GiB of which 2.12 GiB is free. Including non-PyTorch memory, this process has 8.63 GiB memory in use. Of the allocated memory 4.68 GiB is allocated by PyTorch, and 3.73 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2025-08-31 23:08:08,815 - INFO - No scheduler or scheduler type 'None', using empty params
2025-08-31 23:08:08,815 - INFO - Calling train_gd with scheduler_params: {}
2025-08-31 23:08:08,816 - INFO - initial model: max A_j index: 12
2025-08-31 23:08:23,982 - INFO - final model: max A_j index: 12, max A_j value: 0.07783699780702591, alpha_teacher: tensor([0.4614], device='cuda:2')
2025-08-31 23:08:23,983 - INFO - largest 10 A_j values: tensor([0.0778, 0.0766, 0.0726, 0.0722, 0.0702, 0.0685, 0.0676, 0.0670, 0.0641,
        0.0612], device='cuda:2', grad_fn=<TopkBackward0>)
2025-08-31 23:08:23,983 - INFO - number of values below 0.01: 156
2025-08-31 23:08:23,983 - INFO - number of values between 0.01 and 0.1: 94
2025-08-31 23:08:23,983 - INFO - number of values between 0.1 and 0.3: 0
2025-08-31 23:08:23,983 - INFO - number of values larger than 0.3: 0
2025-08-31 23:08:23,984 - INFO - train loss is 1.4007266599946888e-06
2025-08-31 23:08:23,984 - INFO - impulse response loss is 0.016008935868740082
2025-08-31 23:08:23,994 - INFO - Process 2: Completed experiment - student_dim=250, seed=54077
2025-08-31 23:08:26,482 - INFO - final model: max A_j index: 30, max A_j value: 0.13241608440876007, alpha_teacher: tensor([0.4810], device='cuda:0')
2025-08-31 23:08:26,485 - INFO - largest 10 A_j values: tensor([0.1324, 0.1122, 0.1023, 0.0978, 0.0931, 0.0863, 0.0828, 0.0827, 0.0818,
        0.0793], device='cuda:0', grad_fn=<TopkBackward0>)
2025-08-31 23:08:26,485 - INFO - number of values below 0.01: 154
2025-08-31 23:08:26,486 - INFO - number of values between 0.01 and 0.1: 93
2025-08-31 23:08:26,486 - INFO - number of values between 0.1 and 0.3: 3
2025-08-31 23:08:26,487 - INFO - number of values larger than 0.3: 0
2025-08-31 23:08:26,487 - INFO - train loss is 1.960000606260337e-09
2025-08-31 23:08:26,487 - INFO - impulse response loss is 0.02864893153309822
2025-08-31 23:08:26,505 - INFO - Process 0: Completed experiment - student_dim=250, seed=21997
2025-08-31 23:08:29,343 - ERROR - G&C failed for student_dim=275, seed=54077: CUDA out of memory. Tried to allocate 4.10 GiB. GPU 2 has a total capacity of 10.75 GiB of which 1.28 GiB is free. Including non-PyTorch memory, this process has 9.47 GiB memory in use. Of the allocated memory 5.15 GiB is allocated by PyTorch, and 4.10 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-08-31 23:08:29,344 - ERROR - Traceback (most recent call last):
  File "/home/fodl/noacaspi/ssm_generalize/main.py", line 101, in process_worker
    mean_prior, gnc_gen_loss = train_gnc(seed, student_dim, device, alpha_teacher, w_sequences,
                               ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        args_dict['eps_train'], args_dict['gnc_num_samples'],
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        batch_size
                                        ^^^^^^^^^^
                                        )
                                        ^
  File "/home/fodl/noacaspi/ssm_generalize/training.py", line 156, in train_gnc
    train_losses, gen_losses = get_losses(students, w, alpha_teacher)
                               ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/fodl/noacaspi/ssm_generalize/losses.py", line 45, in get_losses
    A_pows = torch.cumprod(X, dim=2)
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 4.10 GiB. GPU 2 has a total capacity of 10.75 GiB of which 1.28 GiB is free. Including non-PyTorch memory, this process has 9.47 GiB memory in use. Of the allocated memory 5.15 GiB is allocated by PyTorch, and 4.10 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2025-08-31 23:08:29,345 - INFO - No scheduler or scheduler type 'None', using empty params
2025-08-31 23:08:29,345 - INFO - Calling train_gd with scheduler_params: {}
2025-08-31 23:08:29,345 - INFO - initial model: max A_j index: 12
2025-08-31 23:08:31,634 - ERROR - G&C failed for student_dim=275, seed=21997: CUDA out of memory. Tried to allocate 4.10 GiB. GPU 0 has a total capacity of 10.75 GiB of which 1.28 GiB is free. Including non-PyTorch memory, this process has 9.47 GiB memory in use. Of the allocated memory 5.15 GiB is allocated by PyTorch, and 4.10 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-08-31 23:08:31,636 - ERROR - Traceback (most recent call last):
  File "/home/fodl/noacaspi/ssm_generalize/main.py", line 101, in process_worker
    mean_prior, gnc_gen_loss = train_gnc(seed, student_dim, device, alpha_teacher, w_sequences,
                               ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        args_dict['eps_train'], args_dict['gnc_num_samples'],
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        batch_size
                                        ^^^^^^^^^^
                                        )
                                        ^
  File "/home/fodl/noacaspi/ssm_generalize/training.py", line 156, in train_gnc
    train_losses, gen_losses = get_losses(students, w, alpha_teacher)
                               ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/fodl/noacaspi/ssm_generalize/losses.py", line 45, in get_losses
    A_pows = torch.cumprod(X, dim=2)
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 4.10 GiB. GPU 0 has a total capacity of 10.75 GiB of which 1.28 GiB is free. Including non-PyTorch memory, this process has 9.47 GiB memory in use. Of the allocated memory 5.15 GiB is allocated by PyTorch, and 4.10 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2025-08-31 23:08:31,636 - INFO - No scheduler or scheduler type 'None', using empty params
2025-08-31 23:08:31,636 - INFO - Calling train_gd with scheduler_params: {}
2025-08-31 23:08:31,637 - INFO - initial model: max A_j index: 30
2025-08-31 23:08:44,421 - INFO - final model: max A_j index: 12, max A_j value: 0.0758972093462944, alpha_teacher: tensor([0.4614], device='cuda:2')
2025-08-31 23:08:44,421 - INFO - largest 10 A_j values: tensor([0.0759, 0.0747, 0.0709, 0.0705, 0.0685, 0.0668, 0.0660, 0.0654, 0.0626,
        0.0598], device='cuda:2', grad_fn=<TopkBackward0>)
2025-08-31 23:08:44,422 - INFO - number of values below 0.01: 177
2025-08-31 23:08:44,422 - INFO - number of values between 0.01 and 0.1: 98
2025-08-31 23:08:44,422 - INFO - number of values between 0.1 and 0.3: 0
2025-08-31 23:08:44,422 - INFO - number of values larger than 0.3: 0
2025-08-31 23:08:44,422 - INFO - train loss is 3.3959935558103282e-12
2025-08-31 23:08:44,422 - INFO - impulse response loss is 0.01595296710729599
2025-08-31 23:08:44,434 - INFO - Process 2: Completed experiment - student_dim=275, seed=54077
2025-08-31 23:08:44,435 - INFO - Process 2 completed on GPU 2
2025-08-31 23:08:49,593 - INFO - Process 2 completed
2025-08-31 23:09:22,314 - INFO - final model: max A_j index: 30, max A_j value: 0.1222747415304184, alpha_teacher: tensor([0.4810], device='cuda:0')
2025-08-31 23:09:22,317 - INFO - largest 10 A_j values: tensor([0.1223, 0.1079, 0.1038, 0.0946, 0.0905, 0.0862, 0.0799, 0.0777, 0.0767,
        0.0766], device='cuda:0', grad_fn=<TopkBackward0>)
2025-08-31 23:09:22,317 - INFO - number of values below 0.01: 165
2025-08-31 23:09:22,318 - INFO - number of values between 0.01 and 0.1: 107
2025-08-31 23:09:22,318 - INFO - number of values between 0.1 and 0.3: 3
2025-08-31 23:09:22,319 - INFO - number of values larger than 0.3: 0
2025-08-31 23:09:22,319 - INFO - train loss is 1.1491654731798917e-05
2025-08-31 23:09:22,319 - INFO - impulse response loss is 0.02981669455766678
2025-08-31 23:09:22,337 - INFO - Process 0: Completed experiment - student_dim=275, seed=21997
2025-08-31 23:09:22,347 - INFO - for seed 9920, alpha_teacher=tensor([0.4378], device='cuda:0'), generated 2 sequences
2025-08-31 23:11:00,692 - WARNING - No GNC sensing losses for student dimension 200 seed 81434
2025-08-31 23:11:00,696 - INFO - No scheduler or scheduler type 'None', using empty params
2025-08-31 23:11:00,696 - INFO - Calling train_gd with scheduler_params: {}
2025-08-31 23:11:00,696 - INFO - initial model: max A_j index: 177
2025-08-31 23:11:50,684 - INFO - final model: max A_j index: 177, max A_j value: 0.11821847409009933, alpha_teacher: tensor([0.3650], device='cuda:3')
2025-08-31 23:11:50,687 - INFO - largest 10 A_j values: tensor([0.1182, 0.0892, 0.0820, 0.0809, 0.0736, 0.0710, 0.0703, 0.0701, 0.0683,
        0.0671], device='cuda:3', grad_fn=<TopkBackward0>)
2025-08-31 23:11:50,687 - INFO - number of values below 0.01: 133
2025-08-31 23:11:50,688 - INFO - number of values between 0.01 and 0.1: 66
2025-08-31 23:11:50,688 - INFO - number of values between 0.1 and 0.3: 1
2025-08-31 23:11:50,688 - INFO - number of values larger than 0.3: 0
2025-08-31 23:11:50,689 - INFO - train loss is 2.98016743727203e-07
2025-08-31 23:11:50,689 - INFO - impulse response loss is 0.00806720182299614
2025-08-31 23:11:50,701 - INFO - Process 3: Completed experiment - student_dim=200, seed=81434
2025-08-31 23:11:54,897 - ERROR - G&C failed for student_dim=225, seed=81434: CUDA out of memory. Tried to allocate 3.35 GiB. GPU 3 has a total capacity of 10.75 GiB of which 2.96 GiB is free. Including non-PyTorch memory, this process has 7.79 GiB memory in use. Of the allocated memory 4.21 GiB is allocated by PyTorch, and 3.35 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-08-31 23:11:54,901 - ERROR - Traceback (most recent call last):
  File "/home/fodl/noacaspi/ssm_generalize/main.py", line 101, in process_worker
    mean_prior, gnc_gen_loss = train_gnc(seed, student_dim, device, alpha_teacher, w_sequences,
                               ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        args_dict['eps_train'], args_dict['gnc_num_samples'],
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        batch_size
                                        ^^^^^^^^^^
                                        )
                                        ^
  File "/home/fodl/noacaspi/ssm_generalize/training.py", line 156, in train_gnc
    train_losses, gen_losses = get_losses(students, w, alpha_teacher)
                               ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/fodl/noacaspi/ssm_generalize/losses.py", line 45, in get_losses
    A_pows = torch.cumprod(X, dim=2)
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.35 GiB. GPU 3 has a total capacity of 10.75 GiB of which 2.96 GiB is free. Including non-PyTorch memory, this process has 7.79 GiB memory in use. Of the allocated memory 4.21 GiB is allocated by PyTorch, and 3.35 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2025-08-31 23:11:54,901 - INFO - No scheduler or scheduler type 'None', using empty params
2025-08-31 23:11:54,901 - INFO - Calling train_gd with scheduler_params: {}
2025-08-31 23:11:54,902 - INFO - initial model: max A_j index: 177
2025-08-31 23:12:44,904 - INFO - final model: max A_j index: 177, max A_j value: 0.10969556868076324, alpha_teacher: tensor([0.3650], device='cuda:3')
2025-08-31 23:12:44,906 - INFO - largest 10 A_j values: tensor([0.1097, 0.0827, 0.0760, 0.0750, 0.0682, 0.0658, 0.0650, 0.0648, 0.0632,
        0.0620], device='cuda:3', grad_fn=<TopkBackward0>)
2025-08-31 23:12:44,907 - INFO - number of values below 0.01: 149
2025-08-31 23:12:44,907 - INFO - number of values between 0.01 and 0.1: 75
2025-08-31 23:12:44,908 - INFO - number of values between 0.1 and 0.3: 1
2025-08-31 23:12:44,908 - INFO - number of values larger than 0.3: 0
2025-08-31 23:12:44,908 - INFO - train loss is 2.875644668676354e-15
2025-08-31 23:12:44,909 - INFO - impulse response loss is 0.008362524211406708
2025-08-31 23:12:44,925 - INFO - Process 3: Completed experiment - student_dim=225, seed=81434
2025-08-31 23:12:49,633 - ERROR - G&C failed for student_dim=250, seed=81434: CUDA out of memory. Tried to allocate 3.73 GiB. GPU 3 has a total capacity of 10.75 GiB of which 2.12 GiB is free. Including non-PyTorch memory, this process has 8.63 GiB memory in use. Of the allocated memory 4.68 GiB is allocated by PyTorch, and 3.73 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-08-31 23:12:49,634 - ERROR - Traceback (most recent call last):
  File "/home/fodl/noacaspi/ssm_generalize/main.py", line 101, in process_worker
    mean_prior, gnc_gen_loss = train_gnc(seed, student_dim, device, alpha_teacher, w_sequences,
                               ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        args_dict['eps_train'], args_dict['gnc_num_samples'],
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        batch_size
                                        ^^^^^^^^^^
                                        )
                                        ^
  File "/home/fodl/noacaspi/ssm_generalize/training.py", line 156, in train_gnc
    train_losses, gen_losses = get_losses(students, w, alpha_teacher)
                               ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/fodl/noacaspi/ssm_generalize/losses.py", line 45, in get_losses
    A_pows = torch.cumprod(X, dim=2)
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.73 GiB. GPU 3 has a total capacity of 10.75 GiB of which 2.12 GiB is free. Including non-PyTorch memory, this process has 8.63 GiB memory in use. Of the allocated memory 4.68 GiB is allocated by PyTorch, and 3.73 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2025-08-31 23:12:49,634 - INFO - No scheduler or scheduler type 'None', using empty params
2025-08-31 23:12:49,634 - INFO - Calling train_gd with scheduler_params: {}
2025-08-31 23:12:49,634 - INFO - initial model: max A_j index: 177
2025-08-31 23:13:39,620 - INFO - final model: max A_j index: 177, max A_j value: 0.10412043333053589, alpha_teacher: tensor([0.3650], device='cuda:3')
2025-08-31 23:13:39,623 - INFO - largest 10 A_j values: tensor([0.1041, 0.0786, 0.0722, 0.0712, 0.0647, 0.0637, 0.0625, 0.0618, 0.0616,
        0.0601], device='cuda:3', grad_fn=<TopkBackward0>)
2025-08-31 23:13:39,623 - INFO - number of values below 0.01: 164
2025-08-31 23:13:39,624 - INFO - number of values between 0.01 and 0.1: 85
2025-08-31 23:13:39,624 - INFO - number of values between 0.1 and 0.3: 1
2025-08-31 23:13:39,624 - INFO - number of values larger than 0.3: 0
2025-08-31 23:13:39,625 - INFO - train loss is 4.555969994714595e-16
2025-08-31 23:13:39,625 - INFO - impulse response loss is 0.008530470542609692
2025-08-31 23:13:39,641 - INFO - Process 3: Completed experiment - student_dim=250, seed=81434
2025-08-31 23:13:44,843 - ERROR - G&C failed for student_dim=275, seed=81434: CUDA out of memory. Tried to allocate 4.10 GiB. GPU 3 has a total capacity of 10.75 GiB of which 1.28 GiB is free. Including non-PyTorch memory, this process has 9.47 GiB memory in use. Of the allocated memory 5.15 GiB is allocated by PyTorch, and 4.10 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-08-31 23:13:44,846 - ERROR - Traceback (most recent call last):
  File "/home/fodl/noacaspi/ssm_generalize/main.py", line 101, in process_worker
    mean_prior, gnc_gen_loss = train_gnc(seed, student_dim, device, alpha_teacher, w_sequences,
                               ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        args_dict['eps_train'], args_dict['gnc_num_samples'],
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        batch_size
                                        ^^^^^^^^^^
                                        )
                                        ^
  File "/home/fodl/noacaspi/ssm_generalize/training.py", line 156, in train_gnc
    train_losses, gen_losses = get_losses(students, w, alpha_teacher)
                               ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/fodl/noacaspi/ssm_generalize/losses.py", line 45, in get_losses
    A_pows = torch.cumprod(X, dim=2)
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 4.10 GiB. GPU 3 has a total capacity of 10.75 GiB of which 1.28 GiB is free. Including non-PyTorch memory, this process has 9.47 GiB memory in use. Of the allocated memory 5.15 GiB is allocated by PyTorch, and 4.10 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2025-08-31 23:13:44,846 - INFO - No scheduler or scheduler type 'None', using empty params
2025-08-31 23:13:44,846 - INFO - Calling train_gd with scheduler_params: {}
2025-08-31 23:13:44,847 - INFO - initial model: max A_j index: 177
2025-08-31 23:14:34,848 - INFO - final model: max A_j index: 177, max A_j value: 0.10067693889141083, alpha_teacher: tensor([0.3650], device='cuda:3')
2025-08-31 23:14:34,850 - INFO - largest 10 A_j values: tensor([0.1007, 0.0762, 0.0700, 0.0691, 0.0628, 0.0606, 0.0600, 0.0598, 0.0583,
        0.0572], device='cuda:3', grad_fn=<TopkBackward0>)
2025-08-31 23:14:34,851 - INFO - number of values below 0.01: 180
2025-08-31 23:14:34,851 - INFO - number of values between 0.01 and 0.1: 94
2025-08-31 23:14:34,852 - INFO - number of values between 0.1 and 0.3: 1
2025-08-31 23:14:34,852 - INFO - number of values larger than 0.3: 0
2025-08-31 23:14:34,852 - INFO - train loss is 8.481073621169344e-09
2025-08-31 23:14:34,852 - INFO - impulse response loss is 0.008662356063723564
2025-08-31 23:14:34,871 - INFO - Process 3: Completed experiment - student_dim=275, seed=81434
2025-08-31 23:14:34,873 - INFO - Process 3 completed on GPU 3
2025-08-31 23:14:44,608 - INFO - Process 3 completed
2025-08-31 23:18:51,668 - WARNING - No GNC sensing losses for student dimension 150 seed 9920
2025-08-31 23:18:51,672 - INFO - No scheduler or scheduler type 'None', using empty params
2025-08-31 23:18:51,672 - INFO - Calling train_gd with scheduler_params: {}
2025-08-31 23:18:51,673 - INFO - initial model: max A_j index: 21
2025-08-31 23:19:43,870 - INFO - final model: max A_j index: 21, max A_j value: 0.1010710597038269, alpha_teacher: tensor([0.4378], device='cuda:0')
2025-08-31 23:19:43,873 - INFO - largest 10 A_j values: tensor([0.1011, 0.0834, 0.0753, 0.0731, 0.0731, 0.0728, 0.0694, 0.0672, 0.0666,
        0.0641], device='cuda:0', grad_fn=<TopkBackward0>)
2025-08-31 23:19:43,874 - INFO - number of values below 0.01: 89
2025-08-31 23:19:43,874 - INFO - number of values between 0.01 and 0.1: 60
2025-08-31 23:19:43,874 - INFO - number of values between 0.1 and 0.3: 1
2025-08-31 23:19:43,875 - INFO - number of values larger than 0.3: 0
2025-08-31 23:19:43,875 - INFO - train loss is 3.4827426134143025e-05
2025-08-31 23:19:43,875 - INFO - impulse response loss is 0.02952558919787407
2025-08-31 23:19:43,885 - INFO - Process 0: Completed experiment - student_dim=150, seed=9920
2025-08-31 23:23:23,413 - WARNING - No GNC sensing losses for student dimension 200 seed 74050
2025-08-31 23:23:23,417 - INFO - No scheduler or scheduler type 'None', using empty params
2025-08-31 23:23:23,418 - INFO - Calling train_gd with scheduler_params: {}
2025-08-31 23:23:23,418 - INFO - initial model: max A_j index: 82
2025-08-31 23:24:12,739 - INFO - final model: max A_j index: 82, max A_j value: 0.10910303145647049, alpha_teacher: tensor([0.5385], device='cuda:1')
2025-08-31 23:24:12,742 - INFO - largest 10 A_j values: tensor([0.1091, 0.0818, 0.0817, 0.0734, 0.0720, 0.0713, 0.0712, 0.0712, 0.0704,
        0.0636], device='cuda:1', grad_fn=<TopkBackward0>)
2025-08-31 23:24:12,742 - INFO - number of values below 0.01: 114
2025-08-31 23:24:12,743 - INFO - number of values between 0.01 and 0.1: 85
2025-08-31 23:24:12,743 - INFO - number of values between 0.1 and 0.3: 1
2025-08-31 23:24:12,744 - INFO - number of values larger than 0.3: 0
2025-08-31 23:24:12,744 - INFO - train loss is 6.322159684657436e-09
2025-08-31 23:24:12,744 - INFO - impulse response loss is 0.05414002016186714
2025-08-31 23:24:12,756 - INFO - Process 1: Completed experiment - student_dim=200, seed=74050
2025-08-31 23:24:16,984 - ERROR - G&C failed for student_dim=225, seed=74050: CUDA out of memory. Tried to allocate 3.35 GiB. GPU 1 has a total capacity of 10.75 GiB of which 2.96 GiB is free. Including non-PyTorch memory, this process has 7.79 GiB memory in use. Of the allocated memory 4.21 GiB is allocated by PyTorch, and 3.35 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-08-31 23:24:16,988 - ERROR - Traceback (most recent call last):
  File "/home/fodl/noacaspi/ssm_generalize/main.py", line 101, in process_worker
    mean_prior, gnc_gen_loss = train_gnc(seed, student_dim, device, alpha_teacher, w_sequences,
                               ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        args_dict['eps_train'], args_dict['gnc_num_samples'],
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        batch_size
                                        ^^^^^^^^^^
                                        )
                                        ^
  File "/home/fodl/noacaspi/ssm_generalize/training.py", line 156, in train_gnc
    train_losses, gen_losses = get_losses(students, w, alpha_teacher)
                               ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/fodl/noacaspi/ssm_generalize/losses.py", line 45, in get_losses
    A_pows = torch.cumprod(X, dim=2)
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.35 GiB. GPU 1 has a total capacity of 10.75 GiB of which 2.96 GiB is free. Including non-PyTorch memory, this process has 7.79 GiB memory in use. Of the allocated memory 4.21 GiB is allocated by PyTorch, and 3.35 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2025-08-31 23:24:16,988 - INFO - No scheduler or scheduler type 'None', using empty params
2025-08-31 23:24:16,988 - INFO - Calling train_gd with scheduler_params: {}
2025-08-31 23:24:16,989 - INFO - initial model: max A_j index: 82
2025-08-31 23:25:06,126 - INFO - final model: max A_j index: 82, max A_j value: 0.09965763241052628, alpha_teacher: tensor([0.5385], device='cuda:1')
2025-08-31 23:25:06,129 - INFO - largest 10 A_j values: tensor([0.0997, 0.0783, 0.0745, 0.0744, 0.0743, 0.0667, 0.0661, 0.0654, 0.0647,
        0.0647], device='cuda:1', grad_fn=<TopkBackward0>)
2025-08-31 23:25:06,130 - INFO - number of values below 0.01: 129
2025-08-31 23:25:06,130 - INFO - number of values between 0.01 and 0.1: 96
2025-08-31 23:25:06,131 - INFO - number of values between 0.1 and 0.3: 0
2025-08-31 23:25:06,131 - INFO - number of values larger than 0.3: 0
2025-08-31 23:25:06,131 - INFO - train loss is 6.827856850577518e-05
2025-08-31 23:25:06,131 - INFO - impulse response loss is 0.05826948955655098
2025-08-31 23:25:06,147 - INFO - Process 1: Completed experiment - student_dim=225, seed=74050
2025-08-31 23:25:10,885 - ERROR - G&C failed for student_dim=250, seed=74050: CUDA out of memory. Tried to allocate 3.73 GiB. GPU 1 has a total capacity of 10.75 GiB of which 2.12 GiB is free. Including non-PyTorch memory, this process has 8.63 GiB memory in use. Of the allocated memory 4.68 GiB is allocated by PyTorch, and 3.73 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-08-31 23:25:10,886 - ERROR - Traceback (most recent call last):
  File "/home/fodl/noacaspi/ssm_generalize/main.py", line 101, in process_worker
    mean_prior, gnc_gen_loss = train_gnc(seed, student_dim, device, alpha_teacher, w_sequences,
                               ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        args_dict['eps_train'], args_dict['gnc_num_samples'],
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        batch_size
                                        ^^^^^^^^^^
                                        )
                                        ^
  File "/home/fodl/noacaspi/ssm_generalize/training.py", line 156, in train_gnc
    train_losses, gen_losses = get_losses(students, w, alpha_teacher)
                               ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/fodl/noacaspi/ssm_generalize/losses.py", line 45, in get_losses
    A_pows = torch.cumprod(X, dim=2)
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.73 GiB. GPU 1 has a total capacity of 10.75 GiB of which 2.12 GiB is free. Including non-PyTorch memory, this process has 8.63 GiB memory in use. Of the allocated memory 4.68 GiB is allocated by PyTorch, and 3.73 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2025-08-31 23:25:10,887 - INFO - No scheduler or scheduler type 'None', using empty params
2025-08-31 23:25:10,887 - INFO - Calling train_gd with scheduler_params: {}
2025-08-31 23:25:10,887 - INFO - initial model: max A_j index: 82
2025-08-31 23:26:00,091 - INFO - final model: max A_j index: 82, max A_j value: 0.0962514877319336, alpha_teacher: tensor([0.5385], device='cuda:1')
2025-08-31 23:26:00,094 - INFO - largest 10 A_j values: tensor([0.0963, 0.0804, 0.0722, 0.0721, 0.0720, 0.0647, 0.0641, 0.0635, 0.0628,
        0.0628], device='cuda:1', grad_fn=<TopkBackward0>)
2025-08-31 23:26:00,095 - INFO - number of values below 0.01: 146
2025-08-31 23:26:00,095 - INFO - number of values between 0.01 and 0.1: 104
2025-08-31 23:26:00,096 - INFO - number of values between 0.1 and 0.3: 0
2025-08-31 23:26:00,096 - INFO - number of values larger than 0.3: 0
2025-08-31 23:26:00,096 - INFO - train loss is 3.9611219193602665e-08
2025-08-31 23:26:00,096 - INFO - impulse response loss is 0.05412811040878296
2025-08-31 23:26:00,113 - INFO - Process 1: Completed experiment - student_dim=250, seed=74050
2025-08-31 23:26:05,323 - ERROR - G&C failed for student_dim=275, seed=74050: CUDA out of memory. Tried to allocate 4.10 GiB. GPU 1 has a total capacity of 10.75 GiB of which 1.28 GiB is free. Including non-PyTorch memory, this process has 9.47 GiB memory in use. Of the allocated memory 5.15 GiB is allocated by PyTorch, and 4.10 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-08-31 23:26:05,325 - ERROR - Traceback (most recent call last):
  File "/home/fodl/noacaspi/ssm_generalize/main.py", line 101, in process_worker
    mean_prior, gnc_gen_loss = train_gnc(seed, student_dim, device, alpha_teacher, w_sequences,
                               ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        args_dict['eps_train'], args_dict['gnc_num_samples'],
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        batch_size
                                        ^^^^^^^^^^
                                        )
                                        ^
  File "/home/fodl/noacaspi/ssm_generalize/training.py", line 156, in train_gnc
    train_losses, gen_losses = get_losses(students, w, alpha_teacher)
                               ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/fodl/noacaspi/ssm_generalize/losses.py", line 45, in get_losses
    A_pows = torch.cumprod(X, dim=2)
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 4.10 GiB. GPU 1 has a total capacity of 10.75 GiB of which 1.28 GiB is free. Including non-PyTorch memory, this process has 9.47 GiB memory in use. Of the allocated memory 5.15 GiB is allocated by PyTorch, and 4.10 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2025-08-31 23:26:05,325 - INFO - No scheduler or scheduler type 'None', using empty params
2025-08-31 23:26:05,325 - INFO - Calling train_gd with scheduler_params: {}
2025-08-31 23:26:05,326 - INFO - initial model: max A_j index: 82
2025-08-31 23:26:54,651 - INFO - final model: max A_j index: 82, max A_j value: 0.09036912769079208, alpha_teacher: tensor([0.5385], device='cuda:1')
2025-08-31 23:26:54,654 - INFO - largest 10 A_j values: tensor([0.0904, 0.0752, 0.0674, 0.0673, 0.0672, 0.0608, 0.0602, 0.0597, 0.0591,
        0.0584], device='cuda:1', grad_fn=<TopkBackward0>)
2025-08-31 23:26:54,654 - INFO - number of values below 0.01: 161
2025-08-31 23:26:54,655 - INFO - number of values between 0.01 and 0.1: 114
2025-08-31 23:26:54,655 - INFO - number of values between 0.1 and 0.3: 0
2025-08-31 23:26:54,655 - INFO - number of values larger than 0.3: 0
2025-08-31 23:26:54,655 - INFO - train loss is 1.672184612999672e-10
2025-08-31 23:26:54,656 - INFO - impulse response loss is 0.05447480082511902
2025-08-31 23:26:54,675 - INFO - Process 1: Completed experiment - student_dim=275, seed=74050
2025-08-31 23:26:54,676 - INFO - Process 1 completed on GPU 1
2025-08-31 23:26:59,633 - INFO - Process 1 completed
2025-08-31 23:30:40,903 - WARNING - No GNC sensing losses for student dimension 175 seed 9920
2025-08-31 23:30:40,907 - INFO - No scheduler or scheduler type 'None', using empty params
2025-08-31 23:30:40,907 - INFO - Calling train_gd with scheduler_params: {}
2025-08-31 23:30:40,908 - INFO - initial model: max A_j index: 21
2025-08-31 23:31:30,989 - INFO - final model: max A_j index: 21, max A_j value: 0.10098523646593094, alpha_teacher: tensor([0.4378], device='cuda:0')
2025-08-31 23:31:30,992 - INFO - largest 10 A_j values: tensor([0.1010, 0.0802, 0.0784, 0.0708, 0.0683, 0.0680, 0.0673, 0.0641, 0.0617,
        0.0610], device='cuda:0', grad_fn=<TopkBackward0>)
2025-08-31 23:31:30,992 - INFO - number of values below 0.01: 101
2025-08-31 23:31:30,993 - INFO - number of values between 0.01 and 0.1: 73
2025-08-31 23:31:30,993 - INFO - number of values between 0.1 and 0.3: 1
2025-08-31 23:31:30,993 - INFO - number of values larger than 0.3: 0
2025-08-31 23:31:30,994 - INFO - train loss is 1.9029299437534064e-05
2025-08-31 23:31:30,994 - INFO - impulse response loss is 0.027461975812911987
2025-08-31 23:31:31,004 - INFO - Process 0: Completed experiment - student_dim=175, seed=9920
2025-08-31 23:44:05,504 - WARNING - No GNC sensing losses for student dimension 200 seed 9920
2025-08-31 23:44:05,510 - INFO - No scheduler or scheduler type 'None', using empty params
2025-08-31 23:44:05,510 - INFO - Calling train_gd with scheduler_params: {}
2025-08-31 23:44:05,511 - INFO - initial model: max A_j index: 21
2025-08-31 23:44:55,640 - INFO - final model: max A_j index: 21, max A_j value: 0.10513142496347427, alpha_teacher: tensor([0.4378], device='cuda:0')
2025-08-31 23:44:55,643 - INFO - largest 10 A_j values: tensor([0.1051, 0.0808, 0.0776, 0.0756, 0.0674, 0.0674, 0.0648, 0.0645, 0.0638,
        0.0626], device='cuda:0', grad_fn=<TopkBackward0>)
2025-08-31 23:44:55,644 - INFO - number of values below 0.01: 118
2025-08-31 23:44:55,644 - INFO - number of values between 0.01 and 0.1: 81
2025-08-31 23:44:55,645 - INFO - number of values between 0.1 and 0.3: 1
2025-08-31 23:44:55,645 - INFO - number of values larger than 0.3: 0
2025-08-31 23:44:55,645 - INFO - train loss is 1.6440915469317918e-12
2025-08-31 23:44:55,645 - INFO - impulse response loss is 0.02689310535788536
2025-08-31 23:44:55,658 - INFO - Process 0: Completed experiment - student_dim=200, seed=9920
2025-08-31 23:44:59,830 - ERROR - G&C failed for student_dim=225, seed=9920: CUDA out of memory. Tried to allocate 3.35 GiB. GPU 0 has a total capacity of 10.75 GiB of which 2.96 GiB is free. Including non-PyTorch memory, this process has 7.79 GiB memory in use. Of the allocated memory 4.21 GiB is allocated by PyTorch, and 3.35 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-08-31 23:44:59,832 - ERROR - Traceback (most recent call last):
  File "/home/fodl/noacaspi/ssm_generalize/main.py", line 101, in process_worker
    mean_prior, gnc_gen_loss = train_gnc(seed, student_dim, device, alpha_teacher, w_sequences,
                               ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        args_dict['eps_train'], args_dict['gnc_num_samples'],
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        batch_size
                                        ^^^^^^^^^^
                                        )
                                        ^
  File "/home/fodl/noacaspi/ssm_generalize/training.py", line 156, in train_gnc
    train_losses, gen_losses = get_losses(students, w, alpha_teacher)
                               ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/fodl/noacaspi/ssm_generalize/losses.py", line 45, in get_losses
    A_pows = torch.cumprod(X, dim=2)
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.35 GiB. GPU 0 has a total capacity of 10.75 GiB of which 2.96 GiB is free. Including non-PyTorch memory, this process has 7.79 GiB memory in use. Of the allocated memory 4.21 GiB is allocated by PyTorch, and 3.35 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2025-08-31 23:44:59,832 - INFO - No scheduler or scheduler type 'None', using empty params
2025-08-31 23:44:59,832 - INFO - Calling train_gd with scheduler_params: {}
2025-08-31 23:44:59,833 - INFO - initial model: max A_j index: 21
2025-08-31 23:45:51,510 - INFO - final model: max A_j index: 21, max A_j value: 0.10589850693941116, alpha_teacher: tensor([0.4378], device='cuda:0')
2025-08-31 23:45:51,512 - INFO - largest 10 A_j values: tensor([0.1059, 0.0822, 0.0802, 0.0721, 0.0695, 0.0692, 0.0685, 0.0674, 0.0652,
        0.0566], device='cuda:0', grad_fn=<TopkBackward0>)
2025-08-31 23:45:51,513 - INFO - number of values below 0.01: 137
2025-08-31 23:45:51,514 - INFO - number of values between 0.01 and 0.1: 87
2025-08-31 23:45:51,514 - INFO - number of values between 0.1 and 0.3: 1
2025-08-31 23:45:51,514 - INFO - number of values larger than 0.3: 0
2025-08-31 23:45:51,515 - INFO - train loss is 1.9738117390533105e-14
2025-08-31 23:45:51,515 - INFO - impulse response loss is 0.02682216838002205
2025-08-31 23:45:51,532 - INFO - Process 0: Completed experiment - student_dim=225, seed=9920
2025-08-31 23:45:51,533 - INFO - Process 0: Starting experiment - student_dim=250, seed=9920
2025-08-31 23:45:56,244 - ERROR - G&C failed for student_dim=250, seed=9920: CUDA out of memory. Tried to allocate 3.73 GiB. GPU 0 has a total capacity of 10.75 GiB of which 2.12 GiB is free. Including non-PyTorch memory, this process has 8.63 GiB memory in use. Of the allocated memory 4.68 GiB is allocated by PyTorch, and 3.73 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-08-31 23:45:56,247 - ERROR - Traceback (most recent call last):
  File "/home/fodl/noacaspi/ssm_generalize/main.py", line 101, in process_worker
    mean_prior, gnc_gen_loss = train_gnc(seed, student_dim, device, alpha_teacher, w_sequences,
                               ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        args_dict['eps_train'], args_dict['gnc_num_samples'],
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        batch_size
                                        ^^^^^^^^^^
                                        )
                                        ^
  File "/home/fodl/noacaspi/ssm_generalize/training.py", line 156, in train_gnc
    train_losses, gen_losses = get_losses(students, w, alpha_teacher)
                               ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/fodl/noacaspi/ssm_generalize/losses.py", line 45, in get_losses
    A_pows = torch.cumprod(X, dim=2)
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.73 GiB. GPU 0 has a total capacity of 10.75 GiB of which 2.12 GiB is free. Including non-PyTorch memory, this process has 8.63 GiB memory in use. Of the allocated memory 4.68 GiB is allocated by PyTorch, and 3.73 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2025-08-31 23:45:56,247 - INFO - No scheduler or scheduler type 'None', using empty params
2025-08-31 23:45:56,247 - INFO - Calling train_gd with scheduler_params: {}
2025-08-31 23:45:56,248 - INFO - initial model: max A_j index: 237
2025-08-31 23:46:48,814 - INFO - final model: max A_j index: 237, max A_j value: 0.11243638396263123, alpha_teacher: tensor([0.4378], device='cuda:0')
2025-08-31 23:46:48,817 - INFO - largest 10 A_j values: tensor([0.1124, 0.0933, 0.0710, 0.0691, 0.0668, 0.0614, 0.0590, 0.0587, 0.0580,
        0.0570], device='cuda:0', grad_fn=<TopkBackward0>)
2025-08-31 23:46:48,817 - INFO - number of values below 0.01: 151
2025-08-31 23:46:48,818 - INFO - number of values between 0.01 and 0.1: 98
2025-08-31 23:46:48,818 - INFO - number of values between 0.1 and 0.3: 1
2025-08-31 23:46:48,819 - INFO - number of values larger than 0.3: 0
2025-08-31 23:46:48,819 - INFO - train loss is 3.719695450854488e-05
2025-08-31 23:46:48,819 - INFO - impulse response loss is 0.03154236078262329
2025-08-31 23:46:48,836 - INFO - Process 0: Completed experiment - student_dim=250, seed=9920
2025-08-31 23:46:53,998 - ERROR - G&C failed for student_dim=275, seed=9920: CUDA out of memory. Tried to allocate 4.10 GiB. GPU 0 has a total capacity of 10.75 GiB of which 1.28 GiB is free. Including non-PyTorch memory, this process has 9.47 GiB memory in use. Of the allocated memory 5.15 GiB is allocated by PyTorch, and 4.10 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-08-31 23:46:54,000 - ERROR - Traceback (most recent call last):
  File "/home/fodl/noacaspi/ssm_generalize/main.py", line 101, in process_worker
    mean_prior, gnc_gen_loss = train_gnc(seed, student_dim, device, alpha_teacher, w_sequences,
                               ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        args_dict['eps_train'], args_dict['gnc_num_samples'],
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                        batch_size
                                        ^^^^^^^^^^
                                        )
                                        ^
  File "/home/fodl/noacaspi/ssm_generalize/training.py", line 156, in train_gnc
    train_losses, gen_losses = get_losses(students, w, alpha_teacher)
                               ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/fodl/noacaspi/ssm_generalize/losses.py", line 45, in get_losses
    A_pows = torch.cumprod(X, dim=2)
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 4.10 GiB. GPU 0 has a total capacity of 10.75 GiB of which 1.28 GiB is free. Including non-PyTorch memory, this process has 9.47 GiB memory in use. Of the allocated memory 5.15 GiB is allocated by PyTorch, and 4.10 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2025-08-31 23:46:54,000 - INFO - No scheduler or scheduler type 'None', using empty params
2025-08-31 23:46:54,001 - INFO - Calling train_gd with scheduler_params: {}
2025-08-31 23:46:54,001 - INFO - initial model: max A_j index: 21
2025-08-31 23:47:49,593 - INFO - final model: max A_j index: 21, max A_j value: 0.10342611372470856, alpha_teacher: tensor([0.4378], device='cuda:0')
2025-08-31 23:47:49,596 - INFO - largest 10 A_j values: tensor([0.1034, 0.0724, 0.0703, 0.0677, 0.0619, 0.0592, 0.0589, 0.0582, 0.0572,
        0.0570], device='cuda:0', grad_fn=<TopkBackward0>)
2025-08-31 23:47:49,596 - INFO - number of values below 0.01: 170
2025-08-31 23:47:49,597 - INFO - number of values between 0.01 and 0.1: 104
2025-08-31 23:47:49,597 - INFO - number of values between 0.1 and 0.3: 1
2025-08-31 23:47:49,597 - INFO - number of values larger than 0.3: 0
2025-08-31 23:47:49,598 - INFO - train loss is 6.965972937367226e-13
2025-08-31 23:47:49,598 - INFO - impulse response loss is 0.027178067713975906
2025-08-31 23:47:49,616 - INFO - Process 0: Completed experiment - student_dim=275, seed=9920
2025-08-31 23:47:49,617 - INFO - Process 0 completed on GPU 0
2025-08-31 23:47:54,676 - INFO - Process 0 completed
2025-08-31 23:47:55,684 - ERROR - Failed to save checkpoint: division by zero
2025-08-31 23:47:55,684 - INFO - Final checkpoint saved
2025-08-31 23:47:55,707 - INFO - Results saved to results__seq_len=5_num_seq=2_seeds=21997-9920-74050-54077-81434_time=20250831_223055.csv
2025-08-31 23:50:23,252 - INFO - Figures saved to plot__seq_len=5_num_seq=2_seeds=21997-9920-74050-54077-81434_time=20250831_223055
2025-08-31 23:50:23,253 - INFO - Finished experiments, results saved to results__seq_len=5_num_seq=2_seeds=21997-9920-74050-54077-81434_time=20250831_223055.csv, figures saved to plot__seq_len=5_num_seq=2_seeds=21997-9920-74050-54077-81434_time=20250831_223055
